R version 4.3.2 (2023-10-31 ucrt) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.    
You are welcome to redistribute it under certain conditions. 
Type 'license()' or 'licence()' for distribution details.    

  Natural language support but running in an English locale

R is a collaborative project with many contributors.       
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> iris = read.csv("D:/Projects/EM-algorithm/data/Iris.csv", header = TRUE, sep$
> 
> iris2 = iris[,1:4]
> #------------------------ Expectation-Maximization Algorithm ---------------$
> gaussmixEM = function(params, X, clusters = 2, tol=.00001, maxits=100, showi$
+   # Arguments: 
+   # params: list of values for mu, var, and probs
+   # X: data matrix
+   # clusters: number of clusters
+   # tol: tolerance for convergence
+   # maxits: maximum number of iterations
+   # showits: print iterations or not
+
+   require(mvtnorm)
+   # Starting points
+   N = nrow(X)
+   mu = params$mu
+   var = params$var
+   probs = params$probs
+
+   # initializations
+   responsibility = matrix(0, ncol=clusters, nrow=N)
+   logLikelihood = 0
+   iteration = 0
+   converged = FALSE
+
+   if (showits)
+     cat(paste("Iterations of EM:", "\n"))
+
+   while (iteration < maxits) { 
+     if(converged) break
+     probsOld = probs
+     logLikelihoodOld = logLikelihood
+     responsibilityOld = responsibility
+     
+ #-------------------------------- Expectation-Step -------------------------$
+     # Compute responsibilities
+     for (k in 1:clusters){
+       responsibility[,k] = probs[k] * dmvnorm(X, mu[k,], sigma = var[[k]], l$
+     }
+     responsibility = responsibility/rowSums(responsibility)
+ #-------------------------------- Maximization-Step ------------------------$
+     rk = colSums(responsibility)
+
+     probs = rk/N
+
+     for (k in 1:clusters){
+       varMatrix = matrix(0, ncol=ncol(X), nrow=ncol(X))
+       for (i in 1:N){
+         varMatrix = varMatrix + responsibility[i,k] * X[i,]%*%t(X[i,])
+       }
+       mu[k,] = (t(X) %*% responsibility[,k]) / rk[k]
+       var[[k]] =  varMatrix/rk[k] - mu[k,]%*%t(mu[k,])
+       logLikelihood[k] = -.5 * sum( responsibility[,k] * dmvnorm(X, mu[k,], $
+     }
+     logLikelihood = sum(logLikelihood)
+
+     cat(paste("logLikelihood at iteration - ", format(iteration), "...", "\n$
+     print(logLikelihood)
+
+     ### compare old to current for convergence
+     paramsOld =  c(logLikelihoodOld, probsOld)
+     paramsCurrent = c(logLikelihood, probs)
+
+     cat(paste("params at iteration - ", format(iteration), "...", "\n", sep $
+     print("paramsOld\n")
+     print(paramsOld)
+     print("paramsCurrent\n")
+     print(paramsCurrent)
+
+     iteration = iteration + 1
+     #if (showits & iteration == 1 | iteration%%5 == 0)
+     #  cat(paste("Iteration - ", format(iteration), "...", "\n", sep = ""))
+     if(any(is.nan(paramsCurrent))) {
+       stop("NaN values found in paramsCurrent")
+     } else if(min(abs(paramsOld - paramsCurrent)) < tol) {
+       converged = TRUE
+     }
+   }
+
+   cluster = which(round(responsibility)==1, arr.ind=T)
+   cluster = cluster[order(cluster[,1]), 2]
+   out = list(probs=probs, mu=mu, var=var, resp=responsibility, cluster=clust$
+ }
> library(plyr)
> 
> # Create starting values
> Mu = daply(iris2, NULL, function(x) colMeans(x)) + runif(4, 0, 0.5)
> Cov = dlply(iris2, NULL, function(x) var(x) + diag(runif(4, 0, 0.5)))
> 
> column.names <- colnames(iris2)
> row.names <- c("Cluster 1", "Cluster 2", "Cluster 3")
> 
> # Create list of starting values
> initMu = array(c(Mu[1] + 0.1, Mu[1] + 0.2, Mu[1] + 0.3, Mu[2] + 0.1, Mu[2] +$
> initCov <- list('Cluster 1' = Cov[[1]], 'Cluster 2' = Cov[[1]], 'Cluster 3' $
> initProbs = c(.1, .2, .7)
>
> initParams = list(mu=initMu, var=initCov, probs=initProbs)  
> 
> print(initParams)
$mu
          SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
Cluster 1      6.250026     3.564024      4.235672     1.527088
Cluster 2      6.350026     3.664024      4.335672     1.627088
Cluster 3      6.450026     3.764024      4.435672     1.827088

$var
$var$`Cluster 1`
              SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
SepalLengthCm    0.83324185  -0.03926846     1.2736823    0.5169038
SepalWidthCm    -0.03926846   0.62384321    -0.3217128   -0.1179812
PetalLengthCm    1.27368233  -0.32171275     3.5538608    1.2963875
PetalWidthCm     0.51690380  -0.11798121     1.2963875    0.8395938

$var$`Cluster 2`
              SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
SepalLengthCm    0.83324185  -0.03926846     1.2736823    0.5169038
SepalWidthCm    -0.03926846   0.62384321    -0.3217128   -0.1179812
PetalLengthCm    1.27368233  -0.32171275     3.5538608    1.2963875
PetalWidthCm     0.51690380  -0.11798121     1.2963875    0.8395938

$var$`Cluster 3`
              SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
SepalLengthCm    0.83324185  -0.03926846     1.2736823    0.5169038
SepalWidthCm    -0.03926846   0.62384321    -0.3217128   -0.1179812
PetalLengthCm    1.27368233  -0.32171275     3.5538608    1.2963875
PetalWidthCm     0.51690380  -0.11798121     1.2963875    0.8395938


$probs
[1] 0.1 0.2 0.7

> 
> # Run and examine
> test = gaussmixEM(params=initParams, X=as.matrix(iris2), clusters = 3, tol=1$
Loading required package: mvtnorm
Iterations of EM:
logLikelihood at iteration - 0...
[1] 189.2127
params at iteration - 0...
[1] "paramsOld\n"
[1] 0.0 0.1 0.2 0.7
[1] "paramsCurrent\n"
[1] 189.2127031   0.1444805   0.2378648   0.6176547
logLikelihood at iteration - 1...
[1] 188.3033
params at iteration - 1...
[1] "paramsOld\n"
[1] 189.2127031   0.1444805   0.2378648   0.6176547
[1] "paramsCurrent\n"
[1] 188.3033080   0.1460579   0.2378547   0.6160874
logLikelihood at iteration - 2...
[1] 185.5105
params at iteration - 2...
[1] "paramsOld\n"
[1] 188.3033080   0.1460579   0.2378547   0.6160874
[1] "paramsCurrent\n"
[1] 185.5104569   0.1517728   0.2385422   0.6096850
logLikelihood at iteration - 3...
[1] 178.9862
params at iteration - 3...
[1] "paramsOld\n"
[1] 185.5104569   0.1517728   0.2385422   0.6096850
[1] "paramsCurrent\n"
[1] 178.9861677   0.1666100   0.2420926   0.5912975
logLikelihood at iteration - 4...
[1] 166.806
params at iteration - 4...
[1] "paramsOld\n"
[1] 178.9861677   0.1666100   0.2420926   0.5912975
[1] "paramsCurrent\n"
[1] 166.8060462   0.1928386   0.2483126   0.5588489
logLikelihood at iteration - 5...
[1] 148.1068
params at iteration - 5...
[1] "paramsOld\n"
[1] 166.8060462   0.1928386   0.2483126   0.5588489
[1] "paramsCurrent\n"
[1] 148.1067883   0.2274592   0.2501962   0.5223446
logLikelihood at iteration - 6...
[1] 124.0219
params at iteration - 6...
[1] "paramsOld\n"
[1] 148.1067883   0.2274592   0.2501962   0.5223446
[1] "paramsCurrent\n"
[1] 124.0219106   0.2634493   0.2410394   0.4955112
logLikelihood at iteration - 7...
[1] 99.76799
params at iteration - 7...
[1] "paramsOld\n"
[1] 124.0219106   0.2634493   0.2410394   0.4955112
[1] "paramsCurrent\n"
[1] 99.7679897  0.2909260  0.2151683  0.4939058
logLikelihood at iteration - 8...
[1] 86.50374
params at iteration - 8...
[1] "paramsOld\n"
[1] 99.7679897  0.2909260  0.2151683  0.4939058
[1] "paramsCurrent\n"
[1] 86.5037357  0.3088238  0.1917710  0.4994052
logLikelihood at iteration - 9...
[1] 71.53421
params at iteration - 9...
[1] "paramsOld\n"
[1] 86.5037357  0.3088238  0.1917710  0.4994052
[1] "paramsCurrent\n"
[1] 71.5342051  0.3197254  0.1752189  0.5050557
logLikelihood at iteration - 10...
[1] 45.97575
params at iteration - 10...
[1] "paramsOld\n"
[1] 71.5342051  0.3197254  0.1752189  0.5050557
[1] "paramsCurrent\n"
[1] 45.9757465  0.3215050  0.1681626  0.5103324
logLikelihood at iteration - 11...
[1] 33.5584
params at iteration - 11...
[1] "paramsOld\n"
[1] 45.9757465  0.3215050  0.1681626  0.5103324
[1] "paramsCurrent\n"
[1] 33.5584021  0.3268733  0.1729359  0.5001907
logLikelihood at iteration - 12...
[1] 32.14427
params at iteration - 12...
[1] "paramsOld\n"
[1] 33.5584021  0.3268733  0.1729359  0.5001907
[1] "paramsCurrent\n"
[1] 32.1442720  0.3278133  0.1860111  0.4861756
logLikelihood at iteration - 13...
[1] 31.15523
params at iteration - 13...
[1] "paramsOld\n"
[1] 32.1442720  0.3278133  0.1860111  0.4861756
[1] "paramsCurrent\n"
[1] 31.1552338  0.3284743  0.1983773  0.4731485
logLikelihood at iteration - 14...
[1] 30.23388
params at iteration - 14...
[1] "paramsOld\n"
[1] 31.1552338  0.3284743  0.1983773  0.4731485
[1] "paramsCurrent\n"
[1] 30.2338782  0.3291964  0.2102105  0.4605931
logLikelihood at iteration - 15...
[1] 29.3069
params at iteration - 15...
[1] "paramsOld\n"
[1] 30.2338782  0.3291964  0.2102105  0.4605931
[1] "paramsCurrent\n"
[1] 29.3069044  0.3300891  0.2215193  0.4483915
logLikelihood at iteration - 16...
[1] 28.35549
params at iteration - 16...
[1] "paramsOld\n"
[1] 29.3069044  0.3300891  0.2215193  0.4483915
[1] "paramsCurrent\n"
[1] 28.3554906  0.3311541  0.2321250  0.4367208
logLikelihood at iteration - 17...
[1] 27.42594
params at iteration - 17...
[1] "paramsOld\n"
[1] 28.3554906  0.3311541  0.2321250  0.4367208
[1] "paramsCurrent\n"
[1] 27.4259374  0.3321344  0.2419836  0.4258821
logLikelihood at iteration - 18...
[1] 26.63077
params at iteration - 18...
[1] "paramsOld\n"
[1] 27.4259374  0.3321344  0.2419836  0.4258821
[1] "paramsCurrent\n"
[1] 26.6307748  0.3327098  0.2511128  0.4161775
logLikelihood at iteration - 19...
[1] 26.01311
params at iteration - 19...
[1] "paramsOld\n"
[1] 26.6307748  0.3327098  0.2511128  0.4161775
[1] "paramsCurrent\n"
[1] 26.0131112  0.3329343  0.2592695  0.4077961
logLikelihood at iteration - 20...
[1] 25.53815
params at iteration - 20...
[1] "paramsOld\n"
[1] 26.0131112  0.3329343  0.2592695  0.4077961
[1] "paramsCurrent\n"
[1] 25.5381509  0.3330116  0.2662735  0.4007149
logLikelihood at iteration - 21...
[1] 25.16924
params at iteration - 21...
[1] "paramsOld\n"
[1] 25.5381509  0.3330116  0.2662735  0.4007149
[1] "paramsCurrent\n"
[1] 25.1692374  0.3330433  0.2721854  0.3947714
logLikelihood at iteration - 22...
[1] 24.88052
params at iteration - 22...
[1] "paramsOld\n"
[1] 25.1692374  0.3330433  0.2721854  0.3947714
[1] "paramsCurrent\n"
[1] 24.8805213  0.3330610  0.2771601  0.3897789
logLikelihood at iteration - 23...
[1] 24.65339
params at iteration - 23...
[1] "paramsOld\n"
[1] 24.8805213  0.3330610  0.2771601  0.3897789
[1] "paramsCurrent\n"
[1] 24.6533887  0.3330737  0.2813555  0.3855708
logLikelihood at iteration - 24...
[1] 24.47429
params at iteration - 24...
[1] "paramsOld\n"
[1] 24.6533887  0.3330737  0.2813555  0.3855708
[1] "paramsCurrent\n"
[1] 24.4742861  0.3330838  0.2849085  0.3820077
logLikelihood at iteration - 25...
[1] 24.33306
params at iteration - 25...
[1] "paramsOld\n"
[1] 24.4742861  0.3330838  0.2849085  0.3820077
[1] "paramsCurrent\n"
[1] 24.3330597  0.3330924  0.2879331  0.3789745
logLikelihood at iteration - 26...
[1] 24.22175
params at iteration - 26...
[1] "paramsOld\n"
[1] 24.3330597  0.3330924  0.2879331  0.3789745
[1] "paramsCurrent\n"
[1] 24.2217503  0.3330999  0.2905231  0.3763770
logLikelihood at iteration - 27...
[1] 24.13392
params at iteration - 27...
[1] "paramsOld\n"
[1] 24.2217503  0.3330999  0.2905231  0.3763770
[1] "paramsCurrent\n"
[1] 24.1339209  0.3331065  0.2927549  0.3741386
logLikelihood at iteration - 28...
[1] 24.06434
params at iteration - 28...
[1] "paramsOld\n"
[1] 24.1339209  0.3331065  0.2927549  0.3741386
[1] "paramsCurrent\n"
[1] 24.0643387  0.3331123  0.2946908  0.3721969
logLikelihood at iteration - 29...
[1] 24.0088
params at iteration - 29...
[1] "paramsOld\n"
[1] 24.0643387  0.3331123  0.2946908  0.3721969
[1] "paramsCurrent\n"
[1] 24.0088020  0.3331174  0.2963809  0.3705017
logLikelihood at iteration - 30...
[1] 23.964
params at iteration - 30...
[1] "paramsOld\n"
[1] 24.0088020  0.3331174  0.2963809  0.3705017
[1] "paramsCurrent\n"
[1] 23.9640035  0.3331219  0.2978656  0.3690125
logLikelihood at iteration - 31...
[1] 23.92739
params at iteration - 31...
[1] "paramsOld\n"
[1] 23.9640035  0.3331219  0.2978656  0.3690125
[1] "paramsCurrent\n"
[1] 23.9273901  0.3331259  0.2991774  0.3676966
logLikelihood at iteration - 32...
[1] 23.89702
params at iteration - 32...
[1] "paramsOld\n"
[1] 23.9273901  0.3331259  0.2991774  0.3676966
[1] "paramsCurrent\n"
[1] 23.8970238  0.3331295  0.3003427  0.3665278
logLikelihood at iteration - 33...
[1] 23.87145
params at iteration - 33...
[1] "paramsOld\n"
[1] 23.8970238  0.3331295  0.3003427  0.3665278
[1] "paramsCurrent\n"
[1] 23.8714519  0.3331327  0.3013826  0.3654847
logLikelihood at iteration - 34...
[1] 23.84959
params at iteration - 34...
[1] "paramsOld\n"
[1] 23.8714519  0.3331327  0.3013826  0.3654847
[1] "paramsCurrent\n"
[1] 23.8495939  0.3331355  0.3023148  0.3645497
logLikelihood at iteration - 35...
[1] 23.83065
params at iteration - 35...
[1] "paramsOld\n"
[1] 23.8495939  0.3331355  0.3023148  0.3645497
[1] "paramsCurrent\n"
[1] 23.8306491  0.3331380  0.3031534  0.3637085
logLikelihood at iteration - 36...
[1] 23.81402
params at iteration - 36...
[1] "paramsOld\n"
[1] 23.8306491  0.3331380  0.3031534  0.3637085
[1] "paramsCurrent\n"
[1] 23.8140246  0.3331403  0.3039105  0.3629492
logLikelihood at iteration - 37...
[1] 23.79928
params at iteration - 37...
[1] "paramsOld\n"
[1] 23.8140246  0.3331403  0.3039105  0.3629492
[1] "paramsCurrent\n"
[1] 23.7992789  0.3331424  0.3045959  0.3622617
logLikelihood at iteration - 38...
[1] 23.78608
params at iteration - 38...
[1] "paramsOld\n"
[1] 23.7992789  0.3331424  0.3045959  0.3622617
[1] "paramsCurrent\n"
[1] 23.7860814  0.3331442  0.3052181  0.3616377
logLikelihood at iteration - 39...
[1] 23.77418
params at iteration - 39...
[1] "paramsOld\n"
[1] 23.7860814  0.3331442  0.3052181  0.3616377
[1] "paramsCurrent\n"
[1] 23.7741814  0.3331459  0.3057841  0.3610700
logLikelihood at iteration - 40...
[1] 23.76339
params at iteration - 40...
[1] "paramsOld\n"
[1] 23.7741814  0.3331459  0.3057841  0.3610700
[1] "paramsCurrent\n"
[1] 23.7633865  0.3331474  0.3063002  0.3605524
logLikelihood at iteration - 41...
[1] 23.75355
params at iteration - 41...
[1] "paramsOld\n"
[1] 23.7633865  0.3331474  0.3063002  0.3605524
[1] "paramsCurrent\n"
[1] 23.7535466  0.3331488  0.3067715  0.3600797
logLikelihood at iteration - 42...
[1] 23.74454
params at iteration - 42...
[1] "paramsOld\n"
[1] 23.7535466  0.3331488  0.3067715  0.3600797
[1] "paramsCurrent\n"
[1] 23.7445426  0.3331500  0.3072027  0.3596473
logLikelihood at iteration - 43...
[1] 23.73628
params at iteration - 43...
[1] "paramsOld\n"
[1] 23.7445426  0.3331500  0.3072027  0.3596473
[1] "paramsCurrent\n"
[1] 23.7362783  0.3331511  0.3075978  0.3592511
logLikelihood at iteration - 44...
[1] 23.72867
params at iteration - 44...
[1] "paramsOld\n"
[1] 23.7362783  0.3331511  0.3075978  0.3592511
[1] "paramsCurrent\n"
[1] 23.7286745  0.3331522  0.3079602  0.3588876
logLikelihood at iteration - 45...
[1] 23.72166
params at iteration - 45...
[1] "paramsOld\n"
[1] 23.7286745  0.3331522  0.3079602  0.3588876
[1] "paramsCurrent\n"
[1] 23.7216649  0.3331531  0.3082931  0.3585538
logLikelihood at iteration - 46...
[1] 23.71519
params at iteration - 46...
[1] "paramsOld\n"
[1] 23.7216649  0.3331531  0.3082931  0.3585538
[1] "paramsCurrent\n"
[1] 23.7151932  0.3331540  0.3085991  0.3582469
logLikelihood at iteration - 47...
[1] 23.70921
params at iteration - 47...
[1] "paramsOld\n"
[1] 23.7151932  0.3331540  0.3085991  0.3582469
[1] "paramsCurrent\n"
[1] 23.7092107  0.3331548  0.3088807  0.3579645
logLikelihood at iteration - 48...
[1] 23.70368
params at iteration - 48...
[1] "paramsOld\n"
[1] 23.7092107  0.3331548  0.3088807  0.3579645
[1] "paramsCurrent\n"
[1] 23.7036751  0.3331555  0.3091402  0.3577043
logLikelihood at iteration - 49...
[1] 23.69855
params at iteration - 49...
[1] "paramsOld\n"
[1] 23.7036751  0.3331555  0.3091402  0.3577043
[1] "paramsCurrent\n"
[1] 23.6985488  0.3331562  0.3093793  0.3574645
logLikelihood at iteration - 50...
[1] 23.6938
params at iteration - 50...
[1] "paramsOld\n"
[1] 23.6985488  0.3331562  0.3093793  0.3574645
[1] "paramsCurrent\n"
[1] 23.6937984  0.3331568  0.3096000  0.3572432
logLikelihood at iteration - 51...
[1] 23.68939
params at iteration - 51...
[1] "paramsOld\n"
[1] 23.6937984  0.3331568  0.3096000  0.3572432
[1] "paramsCurrent\n"
[1] 23.6893941  0.3331574  0.3098037  0.3570390
logLikelihood at iteration - 52...
[1] 23.68531
params at iteration - 52...
[1] "paramsOld\n"
[1] 23.6893941  0.3331574  0.3098037  0.3570390
[1] "paramsCurrent\n"
[1] 23.6853087  0.3331579  0.3099918  0.3568503
logLikelihood at iteration - 53...
[1] 23.68152
params at iteration - 53...
[1] "paramsOld\n"
[1] 23.6853087  0.3331579  0.3099918  0.3568503
[1] "paramsCurrent\n"
[1] 23.6815178  0.3331584  0.3101657  0.3566759
logLikelihood at iteration - 54...
[1] 23.678
params at iteration - 54...
[1] "paramsOld\n"
[1] 23.6815178  0.3331584  0.3101657  0.3566759
[1] "paramsCurrent\n"
[1] 23.6779990  0.3331588  0.3103265  0.3565147
logLikelihood at iteration - 55...
[1] 23.67473
params at iteration - 55...
[1] "paramsOld\n"
[1] 23.6779990  0.3331588  0.3103265  0.3565147
[1] "paramsCurrent\n"
[1] 23.6747318  0.3331592  0.3104753  0.3563655
logLikelihood at iteration - 56...
[1] 23.6717
params at iteration - 56...
[1] "paramsOld\n"
[1] 23.6747318  0.3331592  0.3104753  0.3563655
[1] "paramsCurrent\n"
[1] 23.6716977  0.3331596  0.3106130  0.3562275
logLikelihood at iteration - 57...
[1] 23.66888
params at iteration - 57...
[1] "paramsOld\n"
[1] 23.6716977  0.3331596  0.3106130  0.3562275
[1] "paramsCurrent\n"
[1] 23.6688793  0.3331599  0.3107404  0.3560996
logLikelihood at iteration - 58...
[1] 23.66626
params at iteration - 58...
[1] "paramsOld\n"
[1] 23.6688793  0.3331599  0.3107404  0.3560996
[1] "paramsCurrent\n"
[1] 23.6662608  0.3331603  0.3108585  0.3559812
logLikelihood at iteration - 59...
[1] 23.66383
params at iteration - 59...
[1] "paramsOld\n"
[1] 23.6662608  0.3331603  0.3108585  0.3559812
[1] "paramsCurrent\n"
[1] 23.6638278  0.3331606  0.3109680  0.3558715
logLikelihood at iteration - 60...
[1] 23.66157
params at iteration - 60...
[1] "paramsOld\n"
[1] 23.6638278  0.3331606  0.3109680  0.3558715
[1] "paramsCurrent\n"
[1] 23.6615668  0.3331608  0.3110694  0.3557698
logLikelihood at iteration - 61...
[1] 23.65947
params at iteration - 61...
[1] "paramsOld\n"
[1] 23.6615668  0.3331608  0.3110694  0.3557698
[1] "paramsCurrent\n"
[1] 23.6594653  0.3331611  0.3111634  0.3556755
logLikelihood at iteration - 62...
[1] 23.65751
params at iteration - 62...
[1] "paramsOld\n"
[1] 23.6594653  0.3331611  0.3111634  0.3556755
[1] "paramsCurrent\n"
[1] 23.6575118  0.3331613  0.3112506  0.3555880
logLikelihood at iteration - 63...
[1] 23.6557
params at iteration - 63...
[1] "paramsOld\n"
[1] 23.6575118  0.3331613  0.3112506  0.3555880
[1] "paramsCurrent\n"
[1] 23.6556959  0.3331616  0.3113315  0.3555069
logLikelihood at iteration - 64...
[1] 23.65401
params at iteration - 64...
[1] "paramsOld\n"
[1] 23.6556959  0.3331616  0.3113315  0.3555069
[1] "paramsCurrent\n"
[1] 23.6540076  0.3331618  0.3114066  0.3554317
logLikelihood at iteration - 65...
[1] 23.65244
params at iteration - 65...
[1] "paramsOld\n"
[1] 23.6540076  0.3331618  0.3114066  0.3554317
[1] "paramsCurrent\n"
[1] 23.6524378  0.3331619  0.3114762  0.3553618
logLikelihood at iteration - 66...
[1] 23.65098
params at iteration - 66...
[1] "paramsOld\n"
[1] 23.6524378  0.3331619  0.3114762  0.3553618
[1] "paramsCurrent\n"
[1] 23.6509782  0.3331621  0.3115409  0.3552970
logLikelihood at iteration - 67...
[1] 23.64962
params at iteration - 67...
[1] "paramsOld\n"
[1] 23.6509782  0.3331621  0.3115409  0.3552970
[1] "paramsCurrent\n"
[1] 23.6496208  0.3331623  0.3116009  0.3552368
logLikelihood at iteration - 68...
[1] 23.64836
params at iteration - 68...
[1] "paramsOld\n"
[1] 23.6496208  0.3331623  0.3116009  0.3552368
[1] "paramsCurrent\n"
[1] 23.6483585  0.3331624  0.3116567  0.3551809
logLikelihood at iteration - 69...
[1] 23.64718
params at iteration - 69...
[1] "paramsOld\n"
[1] 23.6483585  0.3331624  0.3116567  0.3551809
[1] "paramsCurrent\n"
[1] 23.6471846  0.3331626  0.3117084  0.3551290
logLikelihood at iteration - 70...
[1] 23.64609
params at iteration - 70...
[1] "paramsOld\n"
[1] 23.6471846  0.3331626  0.3117084  0.3551290
[1] "paramsCurrent\n"
[1] 23.6460927  0.3331627  0.3117565  0.3550808
logLikelihood at iteration - 71...
[1] 23.64508
params at iteration - 71...
[1] "paramsOld\n"
[1] 23.6460927  0.3331627  0.3117565  0.3550808
[1] "paramsCurrent\n"
[1] 23.6450772  0.3331628  0.3118012  0.3550360
logLikelihood at iteration - 72...
[1] 23.64413
params at iteration - 72...
[1] "paramsOld\n"
[1] 23.6450772  0.3331628  0.3118012  0.3550360
[1] "paramsCurrent\n"
[1] 23.6441326  0.3331629  0.3118427  0.3549944
logLikelihood at iteration - 73...
[1] 23.64325
params at iteration - 73...
[1] "paramsOld\n"
[1] 23.6441326  0.3331629  0.3118427  0.3549944
[1] "paramsCurrent\n"
[1] 23.6432539  0.3331630  0.3118812  0.3549557
logLikelihood at iteration - 74...
[1] 23.64244
params at iteration - 74...
[1] "paramsOld\n"
[1] 23.6432539  0.3331630  0.3118812  0.3549557
[1] "paramsCurrent\n"
[1] 23.6424366  0.3331631  0.3119171  0.3549198
logLikelihood at iteration - 75...
[1] 23.64168
params at iteration - 75...
[1] "paramsOld\n"
[1] 23.6424366  0.3331631  0.3119171  0.3549198
[1] "paramsCurrent\n"
[1] 23.6416763  0.3331632  0.3119504  0.3548864
logLikelihood at iteration - 76...
[1] 23.64097
params at iteration - 76...
[1] "paramsOld\n"
[1] 23.6416763  0.3331632  0.3119504  0.3548864
[1] "paramsCurrent\n"
[1] 23.6409689  0.3331633  0.3119813  0.3548553
logLikelihood at iteration - 77...
[1] 23.64031
params at iteration - 77...
[1] "paramsOld\n"
[1] 23.6409689  0.3331633  0.3119813  0.3548553
[1] "paramsCurrent\n"
[1] 23.6403109  0.3331634  0.3120101  0.3548265
logLikelihood at iteration - 78...
[1] 23.6397
params at iteration - 78...
[1] "paramsOld\n"
[1] 23.6403109  0.3331634  0.3120101  0.3548265
[1] "paramsCurrent\n"
[1] 23.6396987  0.3331635  0.3120369  0.3547997
logLikelihood at iteration - 79...
[1] 23.63913
params at iteration - 79...
[1] "paramsOld\n"
[1] 23.6396987  0.3331635  0.3120369  0.3547997
[1] "paramsCurrent\n"
[1] 23.6391292  0.3331635  0.3120617  0.3547747
logLikelihood at iteration - 80...
[1] 23.6386
params at iteration - 80...
[1] "paramsOld\n"
[1] 23.6391292  0.3331635  0.3120617  0.3547747
[1] "paramsCurrent\n"
[1] 23.6385993  0.3331636  0.3120849  0.3547515
logLikelihood at iteration - 81...
[1] 23.63811
params at iteration - 81...
[1] "paramsOld\n"
[1] 23.6385993  0.3331636  0.3120849  0.3547515
[1] "paramsCurrent\n"
[1] 23.6381063  0.3331636  0.3121064  0.3547300
logLikelihood at iteration - 82...
[1] 23.63765
params at iteration - 82...
[1] "paramsOld\n"
[1] 23.6381063  0.3331636  0.3121064  0.3547300
[1] "paramsCurrent\n"
[1] 23.6376476  0.3331637  0.3121264  0.3547099
logLikelihood at iteration - 83...
[1] 23.63722
params at iteration - 83...
[1] "paramsOld\n"
[1] 23.6376476  0.3331637  0.3121264  0.3547099
[1] "paramsCurrent\n"
[1] 23.6372209  0.3331637  0.3121450  0.3546913
logLikelihood at iteration - 84...
[1] 23.63682
params at iteration - 84...
[1] "paramsOld\n"
[1] 23.6372209  0.3331637  0.3121450  0.3546913
[1] "paramsCurrent\n"
[1] 23.6368238  0.3331638  0.3121623  0.3546740
logLikelihood at iteration - 85...
[1] 23.63645
params at iteration - 85...
[1] "paramsOld\n"
[1] 23.6368238  0.3331638  0.3121623  0.3546740
[1] "paramsCurrent\n"
[1] 23.6364543  0.3331638  0.3121783  0.3546578
logLikelihood at iteration - 86...
[1] 23.63611
params at iteration - 86...
[1] "paramsOld\n"
[1] 23.6364543  0.3331638  0.3121783  0.3546578
[1] "paramsCurrent\n"
[1] 23.6361105  0.3331639  0.3121933  0.3546428
logLikelihood at iteration - 87...
[1] 23.63579
params at iteration - 87...
[1] "paramsOld\n"
[1] 23.6361105  0.3331639  0.3121933  0.3546428
[1] "paramsCurrent\n"
[1] 23.6357907  0.3331639  0.3122072  0.3546289
logLikelihood at iteration - 88...
[1] 23.63549
params at iteration - 88...
[1] "paramsOld\n"
[1] 23.6357907  0.3331639  0.3122072  0.3546289
[1] "paramsCurrent\n"
[1] 23.6354930  0.3331639  0.3122201  0.3546159
logLikelihood at iteration - 89...
[1] 23.63522
params at iteration - 89...
[1] "paramsOld\n"
[1] 23.6354930  0.3331639  0.3122201  0.3546159
[1] "paramsCurrent\n"
[1] 23.6352161  0.3331640  0.3122322  0.3546038
logLikelihood at iteration - 90...
[1] 23.63496
params at iteration - 90...
[1] "paramsOld\n"
[1] 23.6352161  0.3331640  0.3122322  0.3546038
[1] "paramsCurrent\n"
[1] 23.6349584  0.3331640  0.3122434  0.3545926
logLikelihood at iteration - 91...
[1] 23.63472
params at iteration - 91...
[1] "paramsOld\n"
[1] 23.6349584  0.3331640  0.3122434  0.3545926
[1] "paramsCurrent\n"
[1] 23.6347186  0.3331640  0.3122538  0.3545822
logLikelihood at iteration - 92...
[1] 23.6345
params at iteration - 92...
[1] "paramsOld\n"
[1] 23.6347186  0.3331640  0.3122538  0.3545822
[1] "paramsCurrent\n"
[1] 23.6344954  0.3331641  0.3122635  0.3545724
logLikelihood at iteration - 93...
[1] 23.63429
params at iteration - 93...
[1] "paramsOld\n"
[1] 23.6344954  0.3331641  0.3122635  0.3545724
[1] "paramsCurrent\n"
[1] 23.6342878  0.3331641  0.3122725  0.3545634
logLikelihood at iteration - 94...
[1] 23.63409
params at iteration - 94...
[1] "paramsOld\n"
[1] 23.6342878  0.3331641  0.3122725  0.3545634
[1] "paramsCurrent\n"
[1] 23.6340946  0.3331641  0.3122809  0.3545550
logLikelihood at iteration - 95...
[1] 23.63391
params at iteration - 95...
[1] "paramsOld\n"
[1] 23.6340946  0.3331641  0.3122809  0.3545550
[1] "paramsCurrent\n"
[1] 23.6339148  0.3331641  0.3122887  0.3545472
logLikelihood at iteration - 96...
[1] 23.63375
params at iteration - 96...
[1] "paramsOld\n"
[1] 23.6339148  0.3331641  0.3122887  0.3545472
[1] "paramsCurrent\n"
[1] 23.6337474  0.3331642  0.3122960  0.3545399
logLikelihood at iteration - 97...
[1] 23.63359
params at iteration - 97...
[1] "paramsOld\n"
[1] 23.6337474  0.3331642  0.3122960  0.3545399
[1] "paramsCurrent\n"
[1] 23.6335918  0.3331642  0.3123027  0.3545331
logLikelihood at iteration - 98...
[1] 23.63345
params at iteration - 98...
[1] "paramsOld\n"
[1] 23.6335918  0.3331642  0.3123027  0.3545331
[1] "paramsCurrent\n"
[1] 23.6334469  0.3331642  0.3123090  0.3545268
logLikelihood at iteration - 99...
[1] 23.63331
params at iteration - 99...
[1] "paramsOld\n"
[1] 23.6334469  0.3331642  0.3123090  0.3545268
[1] "paramsCurrent\n"
[1] 23.6333120  0.3331642  0.3123148  0.3545210
logLikelihood at iteration - 100...
[1] 23.63319
params at iteration - 100...
[1] "paramsOld\n"
[1] 23.6333120  0.3331642  0.3123148  0.3545210
[1] "paramsCurrent\n"
[1] 23.6331866  0.3331642  0.3123203  0.3545155
logLikelihood at iteration - 101...
[1] 23.63307
params at iteration - 101...
[1] "paramsOld\n"
[1] 23.6331866  0.3331642  0.3123203  0.3545155
[1] "paramsCurrent\n"
[1] 23.6330698  0.3331642  0.3123253  0.3545104
logLikelihood at iteration - 102...
[1] 23.63296
params at iteration - 102...
[1] "paramsOld\n"
[1] 23.6330698  0.3331642  0.3123253  0.3545104
[1] "paramsCurrent\n"
[1] 23.6329612  0.3331642  0.3123300  0.3545057
logLikelihood at iteration - 103...
[1] 23.63286
params at iteration - 103...
[1] "paramsOld\n"
[1] 23.6329612  0.3331642  0.3123300  0.3545057
[1] "paramsCurrent\n"
[1] 23.6328601  0.3331643  0.3123344  0.3545013
logLikelihood at iteration - 104...
[1] 23.63277
params at iteration - 104...
[1] "paramsOld\n"
[1] 23.6328601  0.3331643  0.3123344  0.3545013
[1] "paramsCurrent\n"
[1] 23.6327660  0.3331643  0.3123385  0.3544972
logLikelihood at iteration - 105...
[1] 23.63268
params at iteration - 105...
[1] "paramsOld\n"
[1] 23.6327660  0.3331643  0.3123385  0.3544972
[1] "paramsCurrent\n"
[1] 23.6326784  0.3331643  0.3123423  0.3544934
logLikelihood at iteration - 106...
[1] 23.6326
params at iteration - 106...
[1] "paramsOld\n"
[1] 23.6326784  0.3331643  0.3123423  0.3544934
[1] "paramsCurrent\n"
[1] 23.6325969  0.3331643  0.3123458  0.3544899
> 
> print(test)
$probs
[1] 0.3331643 0.3123458 0.3544899

$mu
          SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
Cluster 1      5.006255     3.418564      1.464082    0.2439708
Cluster 2      6.294755     2.777968      4.679893    1.4488715
Cluster 3      6.232300     2.954583      5.103507    1.8754705

$var
$var$`Cluster 1`
     SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
[1,]    0.12169653   0.09805641   0.015782118  0.010355516
[2,]    0.09805641   0.14171746   0.011361294  0.011245253
[3,]    0.01578212   0.01136129   0.029505302  0.005591314
[4,]    0.01035552   0.01124525   0.005591314  0.011267832

$var$`Cluster 2`
     SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
[1,]     0.6156524   0.18588278     0.7248901   0.22542904
[2,]     0.1858828   0.14380414     0.1909597   0.06992836
[3,]     0.7248901   0.19095968     1.0027045   0.31452516
[4,]     0.2254290   0.06992836     0.3145252   0.10900483

$var$`Cluster 3`
     SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
[1,]    0.27518331   0.06929523    0.22078718   0.12622703
[2,]    0.06929523   0.06498525    0.06353291   0.05246449
[3,]    0.22078718   0.06353291    0.30762838   0.17815214
[4,]    0.12622703   0.05246449    0.17815214   0.15553960


$resp
                [,1]         [,2]         [,3]
  [1,]  1.000000e+00 1.485701e-10 3.893179e-20
  [2,]  9.999998e-01 1.928531e-07 8.535952e-16
  [3,]  9.999999e-01 5.153989e-08 2.652425e-17
  [4,]  9.999999e-01 1.022899e-07 2.191484e-14
  [5,]  1.000000e+00 6.481358e-11 1.269316e-20
  [6,]  1.000000e+00 1.937122e-10 9.196760e-22
  [7,]  9.999998e-01 1.599128e-07 2.768993e-17
  [8,]  1.000000e+00 6.388640e-10 6.159818e-18
  [9,]  9.999971e-01 2.941807e-06 1.495041e-13
 [10,]  1.000000e+00 2.219577e-09 6.781289e-15
 [11,]  1.000000e+00 2.777710e-12 6.354501e-22
 [12,]  1.000000e+00 1.052750e-09 4.638044e-16
 [13,]  1.000000e+00 1.451881e-08 4.964411e-15
 [14,]  9.999986e-01 1.432960e-06 1.714677e-15
 [15,]  1.000000e+00 1.296024e-14 3.329559e-29
 [16,]  1.000000e+00 1.409813e-14 2.299365e-31
 [17,]  1.000000e+00 4.878338e-11 6.001265e-26
 [18,]  1.000000e+00 2.586031e-09 2.811693e-20
 [19,]  1.000000e+00 1.197727e-11 1.507620e-21
 [20,]  1.000000e+00 6.469780e-11 5.306111e-22
 [21,]  1.000000e+00 5.223449e-10 1.609530e-16
 [22,]  1.000000e+00 5.391986e-09 7.709570e-21
 [23,]  9.999999e-01 5.314831e-08 1.792000e-21
 [24,]  9.999482e-01 5.178231e-05 1.329678e-14
 [25,]  1.000000e+00 1.640946e-09 4.373279e-12
 [26,]  9.999998e-01 1.930919e-07 7.866298e-14
 [27,]  9.999995e-01 4.611238e-07 8.765654e-17
 [28,]  1.000000e+00 8.944534e-11 2.029787e-19
 [29,]  1.000000e+00 4.018708e-10 1.432085e-19
 [30,]  1.000000e+00 1.858960e-08 2.824650e-14
 [31,]  9.999999e-01 5.651785e-08 5.510792e-14
 [32,]  1.000000e+00 4.362224e-08 4.829161e-19
 [33,]  1.000000e+00 6.672705e-16 5.966474e-25
 [34,]  1.000000e+00 1.771383e-15 5.685200e-29
 [35,]  1.000000e+00 2.219577e-09 6.781289e-15
 [36,]  1.000000e+00 2.266762e-08 3.526091e-19
 [37,]  1.000000e+00 4.609103e-11 4.169562e-22
 [38,]  1.000000e+00 2.219577e-09 6.781289e-15
 [39,]  9.999981e-01 1.905231e-06 6.924571e-15
 [40,]  1.000000e+00 4.785695e-10 2.962506e-18
 [41,]  1.000000e+00 5.611071e-09 8.607294e-21
 [42,]  9.747974e-01 2.520264e-02 7.918529e-13
 [43,]  9.999997e-01 2.723723e-07 7.277034e-16
 [44,]  9.999088e-01 9.121883e-05 4.174124e-16
 [45,]  1.000000e+00 1.443379e-08 8.061401e-17
 [46,]  9.999962e-01 3.841640e-06 1.190949e-15
 [47,]  1.000000e+00 1.753440e-12 9.432318e-21
 [48,]  1.000000e+00 4.746685e-08 5.689720e-16
 [49,]  1.000000e+00 3.805359e-12 1.247590e-21
 [50,]  1.000000e+00 2.909213e-09 3.533617e-18
 [51,]  3.960106e-94 9.588089e-01 4.119112e-02
 [52,]  2.430906e-85 8.331278e-01 1.668722e-01
 [53,] 7.031803e-107 9.181979e-01 8.180214e-02
 [54,]  5.262405e-66 9.585099e-01 4.149012e-02
 [55,]  8.512135e-95 8.101248e-01 1.898752e-01
 [56,]  1.164748e-80 1.471568e-01 8.528432e-01
 [57,]  1.452519e-95 6.010479e-01 3.989521e-01
 [58,]  8.787847e-35 9.850576e-01 1.494243e-02
 [59,]  3.782081e-88 8.757218e-01 1.242782e-01
 [60,]  1.634655e-61 3.227156e-01 6.772844e-01
 [61,]  1.877857e-43 9.981427e-01 1.857336e-03
 [62,]  5.657502e-74 4.802185e-01 5.197815e-01
 [63,]  5.921146e-62 9.810491e-01 1.895093e-02
 [64,]  1.614909e-92 4.806224e-01 5.193776e-01
 [65,]  5.837276e-48 9.512862e-01 4.871377e-02
 [66,]  6.150976e-81 9.427843e-01 5.721571e-02
 [67,]  3.283616e-85 8.893253e-02 9.110675e-01
 [68,]  7.706889e-59 1.349909e-01 8.650091e-01
 [69,]  9.576621e-96 9.640611e-01 3.593887e-02
 [70,]  1.220141e-55 9.047043e-01 9.529569e-02
 [71,] 1.653980e-108 5.759801e-03 9.942402e-01
 [72,]  1.613896e-63 9.495835e-01 5.041649e-02
 [73,] 1.593086e-110 8.837430e-01 1.162570e-01
 [74,]  9.029908e-88 7.653666e-02 9.234633e-01
 [75,]  6.392101e-75 9.303821e-01 6.961792e-02
 [76,]  1.303129e-81 9.232325e-01 7.676749e-02
 [77,] 1.364295e-102 9.225080e-01 7.749200e-02
 [78,] 2.381652e-118 4.773667e-01 5.226333e-01
 [79,]  4.356716e-87 4.833986e-01 5.166014e-01
 [80,]  1.179088e-40 9.920615e-01 7.938513e-03
 [81,]  4.731775e-53 9.645438e-01 3.545620e-02
 [82,]  1.985857e-47 9.563112e-01 4.368881e-02
 [83,]  3.284680e-57 9.479091e-01 5.209092e-02
 [84,] 2.960257e-119 2.488410e-01 7.511590e-01
 [85,]  3.834750e-85 2.262229e-02 9.773777e-01
 [86,]  2.766221e-85 4.227344e-01 5.772656e-01
 [87,]  1.363483e-96 8.816079e-01 1.183921e-01
 [88,]  1.584433e-85 9.872039e-01 1.279614e-02
 [89,]  2.692082e-63 5.589714e-01 4.410286e-01
 [90,]  3.966375e-64 8.665186e-01 1.334814e-01
 [91,]  4.546840e-75 6.727188e-02 9.327281e-01
 [92,]  3.436771e-87 5.639434e-01 4.360566e-01
 [93,]  1.427383e-61 9.332174e-01 6.678257e-02
 [94,]  8.138138e-36 9.959186e-01 4.081358e-03
 [95,]  1.088853e-69 5.708171e-01 4.291829e-01
 [96,]  3.695603e-64 3.066205e-01 6.933795e-01
 [97,]  4.335578e-68 5.616320e-01 4.383680e-01
 [98,]  7.461983e-74 8.800193e-01 1.199807e-01
 [99,]  1.070831e-29 9.992459e-01 7.540689e-04
[100,]  1.778791e-65 7.518398e-01 2.481602e-01
[101,] 1.371768e-207 9.035401e-10 1.000000e+00
[102,] 1.273445e-131 9.817170e-04 9.990183e-01
[103,] 2.013787e-185 6.461526e-02 9.353847e-01
[104,] 1.680940e-151 2.118093e-01 7.881907e-01
[105,] 4.933304e-182 1.375394e-04 9.998625e-01
[106,] 5.326340e-234 9.972854e-01 2.714646e-03
[107,]  5.355431e-97 3.559033e-04 9.996441e-01
[108,] 3.258581e-200 9.957853e-01 4.214670e-03
[109,] 1.125510e-170 9.629210e-01 3.707900e-02
[110,] 7.052241e-212 2.444958e-07 9.999998e-01
[111,] 3.439656e-133 3.690689e-04 9.996309e-01
[112,] 2.009431e-143 3.119515e-02 9.688049e-01
[113,] 4.410955e-162 3.904902e-04 9.996095e-01
[114,] 1.477435e-133 1.971293e-05 9.999803e-01
[115,] 7.092807e-160 6.659547e-15 1.000000e+00
[116,] 1.299266e-159 1.206073e-09 1.000000e+00
[117,] 4.538676e-146 3.582674e-01 6.417326e-01
[118,] 7.692725e-233 9.996265e-01 3.734728e-04
[119,] 7.234308e-272 9.975445e-01 2.455494e-03
[120,] 1.167608e-116 9.525475e-01 4.745246e-02
[121,] 8.908676e-182 1.017038e-06 9.999990e-01
[122,] 1.679108e-126 2.689626e-06 9.999973e-01
[123,] 2.910764e-241 9.998623e-01 1.377334e-04
[124,] 2.249529e-119 2.578354e-02 9.742165e-01
[125,] 6.059635e-168 6.993147e-03 9.930069e-01
[126,] 3.131617e-176 9.786735e-01 2.132654e-02
[127,] 1.915391e-113 1.020596e-02 9.897940e-01
[128,] 1.884430e-115 1.344451e-02 9.865555e-01
[129,] 9.651070e-168 5.679154e-04 9.994321e-01
[130,] 3.917343e-160 9.613552e-01 3.864477e-02
[131,] 1.299855e-194 9.900149e-01 9.985126e-03
[132,] 5.885158e-206 9.999063e-01 9.373728e-05
[133,] 2.286313e-173 8.494294e-06 9.999915e-01
[134,] 4.453546e-116 5.347738e-01 4.652262e-01
[135,] 4.788898e-139 6.731915e-03 9.932681e-01
[136,] 7.544041e-213 2.227485e-04 9.997773e-01
[137,] 2.785696e-178 9.824683e-10 1.000000e+00
[138,] 2.670525e-144 2.337503e-01 7.662497e-01
[139,] 8.767288e-111 6.183303e-03 9.938167e-01
[140,] 3.546688e-156 1.462220e-04 9.998538e-01
[141,] 2.758363e-183 2.771463e-10 1.000000e+00
[142,] 3.190826e-153 7.082763e-12 1.000000e+00
[143,] 1.273445e-131 9.817170e-04 9.990183e-01
[144,] 4.136999e-192 2.084471e-05 9.999792e-01
[145,] 1.733122e-192 7.541304e-12 1.000000e+00
[146,] 2.425609e-158 5.457181e-11 1.000000e+00
[147,] 1.165837e-130 3.499011e-03 9.965010e-01
[148,] 1.880638e-140 5.320450e-04 9.994680e-01
[149,] 1.144427e-161 1.250684e-08 1.000000e+00
[150,] 3.350360e-124 9.380418e-03 9.906196e-01

$cluster
  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 3 2 2 2 3 2 3 2 3 2 2 3 3 2 2 3 2 2 3
 [75] 2 2 2 3 3 2 2 2 2 3 3 3 2 2 2 2 3 2 2 2 2 3 2 2 2 2 3 3 3 3 3 2 3 2 2 3 3
[112] 3 3 3 3 3 3 2 2 2 3 3 2 3 3 2 3 3 3 2 2 2 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[149] 3 3

$logLikelihood
[1] 23.6326

> 
> table(test$cluster, iris$Species)

    Iris-setosa Iris-versicolor Iris-virginica
  1          50               0              0
  2           0              35             12
  3           0              15             38
> 
> #    Iris-setosa Iris-versicolor Iris-virginica
> #  1          50               0              0
> #  2           0              49             16
> #  3           0               1             34
> library(ggplot2)
> 
> png(paste0('D:/Projects/EM-algorithm/plots/em-mgmm-plot-iris-example-', coln$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = iris, aes(x = iris2$SepalLengthCm, y = iris2$SepalWidthCm, col$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(test$mu), aes(x = test$mu[,1], y = test$mu$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(iris2)$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> png(paste0('D:/Projects/EM-algorithm/plots/em-mgmm-plot-iris-example-', coln$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = iris, aes(x = iris2$SepalLengthCm, y = iris2$SepalWidthCm, col$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(test$mu), aes(x = test$mu[,3], y = test$mu$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(iris2)$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> km_data <- kmeans(iris2, 3, nstart=1500) 
> 
> print(km_data)
K-means clustering with 3 clusters of sizes 38, 62, 50

Cluster means:
  SepalLengthCm SepalWidthCm PetalLengthCm PetalWidthCm
1      6.850000     3.073684      5.742105     2.071053
2      5.901613     2.748387      4.393548     1.433871
3      5.006000     3.418000      1.464000     0.244000

Clustering vector:
  [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 [38] 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 1 1 1 1 2 1 1 1 1
[112] 1 1 2 2 1 1 1 1 2 1 2 1 2 1 1 2 2 1 1 1 1 1 2 1 1 1 1 2 1 1 1 2 1 1 1 2 1
[149] 1 2

Within cluster sum of squares by cluster:
[1] 23.87947 39.82097 15.24040
 (between_SS / total_SS =  88.4 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"
> 
> table(km_data$cluster, iris$Species)

    Iris-setosa Iris-versicolor Iris-virginica
  1           0               2             36
  2           0              48             14
  3          50               0              0
> library(ggplot2)
> 
> png(paste0('D:/Projects/EM-algorithm/plots/kmeans-plot-iris-example-', colna$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = iris2, aes(x = iris2[,1], y = iris2[,2], color = as.factor(km_$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(km_data$centers), aes(x = km_data$centers[$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(iris2)$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> library(ggplot2)
> 
> png(paste0('D:/Projects/EM-algorithm/plots/kmeans-plot-iris-example-', colna$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = iris2, aes(x = iris2[,3], y = iris2[,4], color = as.factor(km_$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(km_data$centers), aes(x = km_data$centers[$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(iris2)$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> MallCustomers = read.csv("D:/Projects/EM-algorithm/data/Mall_Customers_Clean$
> # Select columns for analysis
> X <- MallCustomers[,c(2,3,4)]
> library(plyr)
> # Create starting values
> Mu = daply(X, NULL, function(x) colMeans(x)) + runif(3, 0, .5)
> Cov = dlply(X, NULL, function(x) var(x) + diag(runif(3, 0, .5)))
> 
> column.names <- c("Age", "Annual Income (k$)", "Spending Score (1-100)")
> row.names <- c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4")
> 
> initMu = array(c(Mu[1], Mu[1] + runif(1, min=-0.1, max=0.1), Mu[1] + runif(1$
> initCov <- list('Cluster 1' = Cov[[1]], 'Cluster 2' = Cov[[1]], 'Cluster 3' $
> initProbs = c(.1, .3, .6, 0.9)
> 
> initParams <- list(mu = initMu, var = initCov, probs = initProbs)
> 
> print(initParams)
$mu
               Age Annual Income (k$) Spending Score (1-100)
Cluster 1 39.02510           60.99791               50.51600
Cluster 2 39.03367           60.96141               50.44283
Cluster 3 39.05480           61.07790               50.49472
Cluster 4 38.93174           61.02215               50.47345

$var
$var$`Cluster 1`
                               Age Annual.Income..k.. Spending.Score..1.100.
Age                     195.454833          -4.548744            -118.040201
Annual.Income..k..       -4.548744         689.851948               6.716583
Spending.Score..1.100. -118.040201           6.716583             667.060805

$var$`Cluster 2`
                               Age Annual.Income..k.. Spending.Score..1.100.
Age                     195.454833          -4.548744            -118.040201
Annual.Income..k..       -4.548744         689.851948               6.716583
Spending.Score..1.100. -118.040201           6.716583             667.060805

$var$`Cluster 3`
                               Age Annual.Income..k.. Spending.Score..1.100.
Age                     195.454833          -4.548744            -118.040201
Annual.Income..k..       -4.548744         689.851948               6.716583
Spending.Score..1.100. -118.040201           6.716583             667.060805

$var$`Cluster 4`
                               Age Annual.Income..k.. Spending.Score..1.100.
Age                     195.454833          -4.548744            -118.040201
Annual.Income..k..       -4.548744         689.851948               6.716583
Spending.Score..1.100. -118.040201           6.716583             667.060805


$probs
[1] 0.1 0.3 0.6 0.9

> # Run and examine
> results = gaussmixEM(params=initParams, X=as.matrix(X), clusters = 4, tol=1e$
Iterations of EM: 
logLikelihood at iteration - 0...
[1] 1334.891
params at iteration - 0...
[1] "paramsOld\n"
[1] 0.0 0.1 0.3 0.6 0.9
[1] "paramsCurrent\n"
[1] 1.334891e+03 5.262952e-02 1.578980e-01 3.157536e-01 4.737189e-01
logLikelihood at iteration - 1...
[1] 1334.89
params at iteration - 1...
[1] "paramsOld\n"
[1] 1.334891e+03 5.262952e-02 1.578980e-01 3.157536e-01 4.737189e-01
[1] "paramsCurrent\n"
[1] 1.334890e+03 5.262945e-02 1.578979e-01 3.157536e-01 4.737190e-01
logLikelihood at iteration - 2...
[1] 1334.887
params at iteration - 2...
[1] "paramsOld\n"
[1] 1.334890e+03 5.262945e-02 1.578979e-01 3.157536e-01 4.737190e-01
[1] "paramsCurrent\n"
[1] 1.334887e+03 5.262929e-02 1.578977e-01 3.157536e-01 4.737193e-01
logLikelihood at iteration - 3...
[1] 1334.879
params at iteration - 3...
[1] "paramsOld\n"
[1] 1.334887e+03 5.262929e-02 1.578977e-01 3.157536e-01 4.737193e-01
[1] "paramsCurrent\n"
[1] 1.334879e+03 5.262889e-02 1.578974e-01 3.157533e-01 4.737203e-01
logLikelihood at iteration - 4...
[1] 1334.857
params at iteration - 4...
[1] "paramsOld\n"
[1] 1.334879e+03 5.262889e-02 1.578974e-01 3.157533e-01 4.737203e-01
[1] "paramsCurrent\n"
[1] 1.334857e+03 5.262788e-02 1.578966e-01 3.157522e-01 4.737233e-01
logLikelihood at iteration - 5...
[1] 1334.801
params at iteration - 5...
[1] "paramsOld\n"
[1] 1.334857e+03 5.262788e-02 1.578966e-01 3.157522e-01 4.737233e-01
[1] "paramsCurrent\n"
[1] 1.334801e+03 5.262536e-02 1.578942e-01 3.157487e-01 4.737318e-01
logLikelihood at iteration - 6...
[1] 1334.654
params at iteration - 6...
[1] "paramsOld\n"
[1] 1.334801e+03 5.262536e-02 1.578942e-01 3.157487e-01 4.737318e-01
[1] "paramsCurrent\n"
[1] 1.334654e+03 5.261893e-02 1.578864e-01 3.157392e-01 4.737555e-01
logLikelihood at iteration - 7...
[1] 1334.273
params at iteration - 7...
[1] "paramsOld\n"
[1] 1.334654e+03 5.261893e-02 1.578864e-01 3.157392e-01 4.737555e-01
[1] "paramsCurrent\n"
[1] 1.334273e+03 5.260259e-02 1.578615e-01 3.157152e-01 4.738207e-01
logLikelihood at iteration - 8...
[1] 1333.307
params at iteration - 8...
[1] "paramsOld\n"
[1] 1.334273e+03 5.260259e-02 1.578615e-01 3.157152e-01 4.738207e-01
[1] "paramsCurrent\n"
[1] 1.333307e+03 5.256113e-02 1.577816e-01 3.156596e-01 4.739977e-01
logLikelihood at iteration - 9...
[1] 1330.982
params at iteration - 9...
[1] "paramsOld\n"
[1] 1.333307e+03 5.256113e-02 1.577816e-01 3.156596e-01 4.739977e-01
[1] "paramsCurrent\n"
[1] 1.330982e+03 5.245479e-02 1.575210e-01 3.155268e-01 4.744974e-01
logLikelihood at iteration - 10...
[1] 1325.962
params at iteration - 10...
[1] "paramsOld\n"
[1] 1.330982e+03 5.245479e-02 1.575210e-01 3.155268e-01 4.744974e-01
[1] "paramsCurrent\n"
[1] 1.325962e+03 5.217191e-02 1.566573e-01 3.151144e-01 4.760564e-01
logLikelihood at iteration - 11...
[1] 1316.904
params at iteration - 11...
[1] "paramsOld\n"
[1] 1.325962e+03 5.217191e-02 1.566573e-01 3.151144e-01 4.760564e-01
[1] "paramsCurrent\n"
[1] 1.316904e+03 5.144866e-02 1.540561e-01 3.138275e-01 4.806678e-01
logLikelihood at iteration - 12...
[1] 1304.01
params at iteration - 12...
[1] "paramsOld\n"
[1] 1.316904e+03 5.144866e-02 1.540561e-01 3.138275e-01 4.806678e-01
[1] "paramsCurrent\n"
[1] 1.304010e+03 4.999904e-02 1.480652e-01 3.118133e-01 4.901224e-01
logLikelihood at iteration - 13...
[1] 1289.528
params at iteration - 13...
[1] "paramsOld\n"
[1] 1.304010e+03 4.999904e-02 1.480652e-01 3.118133e-01 4.901224e-01
[1] "paramsCurrent\n"
[1] 1.289528e+03 4.791986e-02 1.378591e-01 3.125206e-01 5.017004e-01
logLikelihood at iteration - 14...
[1] 1277.326
params at iteration - 14...
[1] "paramsOld\n"
[1] 1.289528e+03 4.791986e-02 1.378591e-01 3.125206e-01 5.017004e-01
[1] "paramsCurrent\n"
[1] 1.277326e+03 4.581981e-02 1.243524e-01 3.192208e-01 5.106070e-01
logLikelihood at iteration - 15...
[1] 1269.556
params at iteration - 15...
[1] "paramsOld\n"
[1] 1.277326e+03 4.581981e-02 1.243524e-01 3.192208e-01 5.106070e-01
[1] "paramsCurrent\n"
[1] 1.269556e+03 4.461433e-02 1.125123e-01 3.253240e-01 5.175493e-01
logLikelihood at iteration - 16...
[1] 1263.166
params at iteration - 16...
[1] "paramsOld\n"
[1] 1.269556e+03 4.461433e-02 1.125123e-01 3.253240e-01 5.175493e-01
[1] "paramsCurrent\n"
[1] 1263.1658558    0.0436092    0.1097298    0.3236128    0.5230482
logLikelihood at iteration - 17...
[1] 1255.21
params at iteration - 17...
[1] "paramsOld\n"
[1] 1263.1658558    0.0436092    0.1097298    0.3236128    0.5230482
[1] "paramsCurrent\n"
[1] 1.255210e+03 4.153075e-02 1.250069e-01 3.091854e-01 5.242769e-01
logLikelihood at iteration - 18...
[1] 1245.808
params at iteration - 18...
[1] "paramsOld\n"
[1] 1.255210e+03 4.153075e-02 1.250069e-01 3.091854e-01 5.242769e-01
[1] "paramsCurrent\n"
[1] 1.245808e+03 3.852753e-02 1.549465e-01 2.849187e-01 5.216072e-01
logLikelihood at iteration - 19...
[1] 1237.425
params at iteration - 19...
[1] "paramsOld\n"
[1] 1.245808e+03 3.852753e-02 1.549465e-01 2.849187e-01 5.216072e-01
[1] "paramsCurrent\n"
[1] 1.237425e+03 3.586925e-02 1.836798e-01 2.625274e-01 5.179236e-01
logLikelihood at iteration - 20...
[1] 1232.609
params at iteration - 20...
[1] "paramsOld\n"
[1] 1.237425e+03 3.586925e-02 1.836798e-01 2.625274e-01 5.179236e-01
[1] "paramsCurrent\n"
[1] 1.232609e+03 3.400366e-02 2.039452e-01 2.466677e-01 5.153835e-01
logLikelihood at iteration - 21...
[1] 1229.997
params at iteration - 21...
[1] "paramsOld\n"
[1] 1.232609e+03 3.400366e-02 2.039452e-01 2.466677e-01 5.153835e-01
[1] "paramsCurrent\n"
[1] 1.229997e+03 3.272294e-02 2.184627e-01 2.354529e-01 5.133615e-01
logLikelihood at iteration - 22...
[1] 1227.966
params at iteration - 22...
[1] "paramsOld\n"
[1] 1.229997e+03 3.272294e-02 2.184627e-01 2.354529e-01 5.133615e-01
[1] "paramsCurrent\n"
[1] 1.227966e+03 3.185543e-02 2.306104e-01 2.267702e-01 5.107640e-01
logLikelihood at iteration - 23...
[1] 1225.636
params at iteration - 23...
[1] "paramsOld\n"
[1] 1.227966e+03 3.185543e-02 2.306104e-01 2.267702e-01 5.107640e-01
[1] "paramsCurrent\n"
[1] 1225.6364982    0.0314912    0.2414836    0.2198711    0.5071541
logLikelihood at iteration - 24...
[1] 1222.525
params at iteration - 24...
[1] "paramsOld\n"
[1] 1225.6364982    0.0314912    0.2414836    0.2198711    0.5071541
[1] "paramsCurrent\n"
[1] 1.222525e+03 3.195883e-02 2.506790e-01 2.150603e-01 5.023018e-01
logLikelihood at iteration - 25...
[1] 1218.694
params at iteration - 25...
[1] "paramsOld\n"
[1] 1.222525e+03 3.195883e-02 2.506790e-01 2.150603e-01 5.023018e-01
[1] "paramsCurrent\n"
[1] 1.218694e+03 3.346494e-02 2.573651e-01 2.130380e-01 4.961320e-01
logLikelihood at iteration - 26...
[1] 1214.947
params at iteration - 26...
[1] "paramsOld\n"
[1] 1.218694e+03 3.346494e-02 2.573651e-01 2.130380e-01 4.961320e-01
[1] "paramsCurrent\n"
[1] 1.214947e+03 3.542951e-02 2.613638e-01 2.135042e-01 4.897025e-01
logLikelihood at iteration - 27...
[1] 1211.887
params at iteration - 27...
[1] "paramsOld\n"
[1] 1.214947e+03 3.542951e-02 2.613638e-01 2.135042e-01 4.897025e-01
[1] "paramsCurrent\n"
[1] 1.211887e+03 3.706819e-02 2.633799e-01 2.151275e-01 4.844244e-01
logLikelihood at iteration - 28...
[1] 1209.305
params at iteration - 28...
[1] "paramsOld\n"
[1] 1.211887e+03 3.706819e-02 2.633799e-01 2.151275e-01 4.844244e-01
[1] "paramsCurrent\n"
[1] 1.209305e+03 3.847619e-02 2.642993e-01 2.168510e-01 4.803735e-01
logLikelihood at iteration - 29...
[1] 1206.986
params at iteration - 29...
[1] "paramsOld\n"
[1] 1.209305e+03 3.847619e-02 2.642993e-01 2.168510e-01 4.803735e-01
[1] "paramsCurrent\n"
[1] 1.206986e+03 4.001585e-02 2.648219e-01 2.179183e-01 4.772440e-01
logLikelihood at iteration - 30...
[1] 1205.088
params at iteration - 30...
[1] "paramsOld\n"
[1] 1.206986e+03 4.001585e-02 2.648219e-01 2.179183e-01 4.772440e-01
[1] "paramsCurrent\n"
[1] 1.205088e+03 4.171933e-02 2.654041e-01 2.177074e-01 4.751692e-01
logLikelihood at iteration - 31...
[1] 1203.574
params at iteration - 31...
[1] "paramsOld\n"
[1] 1.205088e+03 4.171933e-02 2.654041e-01 2.177074e-01 4.751692e-01
[1] "paramsCurrent\n"
[1] 1.203574e+03 4.345493e-02 2.660375e-01 2.161577e-01 4.743499e-01
logLikelihood at iteration - 32...
[1] 1202.138
params at iteration - 32...
[1] "paramsOld\n"
[1] 1.203574e+03 4.345493e-02 2.660375e-01 2.161577e-01 4.743499e-01
[1] "paramsCurrent\n"
[1] 1.202138e+03 4.493776e-02 2.666188e-01 2.138209e-01 4.746225e-01
logLikelihood at iteration - 33...
[1] 1200.884
params at iteration - 33...
[1] "paramsOld\n"
[1] 1.202138e+03 4.493776e-02 2.666188e-01 2.138209e-01 4.746225e-01
[1] "paramsCurrent\n"
[1] 1200.8840550    0.0452977    0.2671371    0.2116670    0.4758982
logLikelihood at iteration - 34...
[1] 1199.874
params at iteration - 34...
[1] "paramsOld\n"
[1] 1200.8840550    0.0452977    0.2671371    0.2116670    0.4758982
[1] "paramsCurrent\n"
[1] 1.199874e+03 4.447135e-02 2.675025e-01 2.100308e-01 4.779954e-01
logLikelihood at iteration - 35...
[1] 1198.952
params at iteration - 35...
[1] "paramsOld\n"
[1] 1.199874e+03 4.447135e-02 2.675025e-01 2.100308e-01 4.779954e-01
[1] "paramsCurrent\n"
[1] 1198.9521899    0.0432569    0.2676013    0.2088786    0.4802632
logLikelihood at iteration - 36...
[1] 1198.441
params at iteration - 36...
[1] "paramsOld\n"
[1] 1198.9521899    0.0432569    0.2676013    0.2088786    0.4802632
[1] "paramsCurrent\n"
[1] 1.198441e+03 4.190727e-02 2.674790e-01 2.082567e-01 4.823570e-01
logLikelihood at iteration - 37...
[1] 1198.162
params at iteration - 37...
[1] "paramsOld\n"
[1] 1.198441e+03 4.190727e-02 2.674790e-01 2.082567e-01 4.823570e-01
[1] "paramsCurrent\n"
[1] 1.198162e+03 4.064475e-02 2.672796e-01 2.078253e-01 4.842503e-01
logLikelihood at iteration - 38...
[1] 1198.055
params at iteration - 38...
[1] "paramsOld\n"
[1] 1.198162e+03 4.064475e-02 2.672796e-01 2.078253e-01 4.842503e-01
[1] "paramsCurrent\n"
[1] 1.198055e+03 3.997183e-02 2.670934e-01 2.072741e-01 4.856607e-01
logLikelihood at iteration - 39...
[1] 1198.157
params at iteration - 39...
[1] "paramsOld\n"
[1] 1.198055e+03 3.997183e-02 2.670934e-01 2.072741e-01 4.856607e-01
[1] "paramsCurrent\n"
[1] 1.198157e+03 3.957706e-02 2.669803e-01 2.066905e-01 4.867521e-01
logLikelihood at iteration - 40...
[1] 1198.264
params at iteration - 40...
[1] "paramsOld\n"
[1] 1.198157e+03 3.957706e-02 2.669803e-01 2.066905e-01 4.867521e-01
[1] "paramsCurrent\n"
[1] 1.198264e+03 3.931213e-02 2.669324e-01 2.061823e-01 4.875731e-01
logLikelihood at iteration - 41...
[1] 1198.346
params at iteration - 41...
[1] "paramsOld\n"
[1] 1.198264e+03 3.931213e-02 2.669324e-01 2.061823e-01 4.875731e-01
[1] "paramsCurrent\n"
[1] 1.198346e+03 3.910642e-02 2.669195e-01 2.057802e-01 4.881939e-01
logLikelihood at iteration - 42...
[1] 1198.412
params at iteration - 42...
[1] "paramsOld\n"
[1] 1.198346e+03 3.910642e-02 2.669195e-01 2.057802e-01 4.881939e-01
[1] "paramsCurrent\n"
[1] 1.198412e+03 3.892217e-02 2.669208e-01 2.054738e-01 4.886832e-01
logLikelihood at iteration - 43...
[1] 1198.468
params at iteration - 43...
[1] "paramsOld\n"
[1] 1.198412e+03 3.892217e-02 2.669208e-01 2.054738e-01 4.886832e-01
[1] "paramsCurrent\n"
[1] 1.198468e+03 3.874458e-02 2.669264e-01 2.052419e-01 4.890871e-01
logLikelihood at iteration - 44...
[1] 1198.518
params at iteration - 44...
[1] "paramsOld\n"
[1] 1.198468e+03 3.874458e-02 2.669264e-01 2.052419e-01 4.890871e-01
[1] "paramsCurrent\n"
[1] 1.198518e+03 3.856659e-02 2.669319e-01 2.050654e-01 4.894361e-01
logLikelihood at iteration - 45...
[1] 1198.565
params at iteration - 45...
[1] "paramsOld\n"
[1] 1.198518e+03 3.856659e-02 2.669319e-01 2.050654e-01 4.894361e-01
[1] "paramsCurrent\n"
[1] 1.198565e+03 3.838352e-02 2.669355e-01 2.049295e-01 4.897515e-01
logLikelihood at iteration - 46...
[1] 1198.608
params at iteration - 46...
[1] "paramsOld\n"
[1] 1.198565e+03 3.838352e-02 2.669355e-01 2.049295e-01 4.897515e-01
[1] "paramsCurrent\n"
[1] 1.198608e+03 3.819189e-02 2.669366e-01 2.048235e-01 4.900480e-01
logLikelihood at iteration - 47...
[1] 1198.648
params at iteration - 47...
[1] "paramsOld\n"
[1] 1.198608e+03 3.819189e-02 2.669366e-01 2.048235e-01 4.900480e-01
[1] "paramsCurrent\n"
[1] 1.198648e+03 3.798969e-02 2.669352e-01 2.047398e-01 4.903353e-01
logLikelihood at iteration - 48...
[1] 1198.686
params at iteration - 48...
[1] "paramsOld\n"
[1] 1.198648e+03 3.798969e-02 2.669352e-01 2.047398e-01 4.903353e-01
[1] "paramsCurrent\n"
[1] 1.198686e+03 3.777759e-02 2.669313e-01 2.046739e-01 4.906172e-01
logLikelihood at iteration - 49...
[1] 1198.721
params at iteration - 49...
[1] "paramsOld\n"
[1] 1.198686e+03 3.777759e-02 2.669313e-01 2.046739e-01 4.906172e-01
[1] "paramsCurrent\n"
[1] 1.198721e+03 3.756039e-02 2.669251e-01 2.046238e-01 4.908907e-01
logLikelihood at iteration - 50...
[1] 1198.753
params at iteration - 50...
[1] "paramsOld\n"
[1] 1.198721e+03 3.756039e-02 2.669251e-01 2.046238e-01 4.908907e-01
[1] "paramsCurrent\n"
[1] 1.198753e+03 3.734768e-02 2.669170e-01 2.045897e-01 4.911456e-01
logLikelihood at iteration - 51...
[1] 1198.783
params at iteration - 51...
[1] "paramsOld\n"
[1] 1.198753e+03 3.734768e-02 2.669170e-01 2.045897e-01 4.911456e-01
[1] "paramsCurrent\n"
[1] 1.198783e+03 3.715144e-02 2.669071e-01 2.045739e-01 4.913676e-01
logLikelihood at iteration - 52...
[1] 1198.812
params at iteration - 52...
[1] "paramsOld\n"
[1] 1.198783e+03 3.715144e-02 2.669071e-01 2.045739e-01 4.913676e-01
[1] "paramsCurrent\n"
[1] 1.198812e+03 3.698121e-02 2.668962e-01 2.045784e-01 4.915443e-01
logLikelihood at iteration - 53...
[1] 1198.842
params at iteration - 53...
[1] "paramsOld\n"
[1] 1.198812e+03 3.698121e-02 2.668962e-01 2.045784e-01 4.915443e-01
[1] "paramsCurrent\n"
[1] 1.198842e+03 3.684069e-02 2.668845e-01 2.046031e-01 4.916717e-01
logLikelihood at iteration - 54...
[1] 1198.87
params at iteration - 54...
[1] "paramsOld\n"
[1] 1.198842e+03 3.684069e-02 2.668845e-01 2.046031e-01 4.916717e-01
[1] "paramsCurrent\n"
[1] 1.198870e+03 3.672856e-02 2.668725e-01 2.046444e-01 4.917546e-01
logLikelihood at iteration - 55...
[1] 1198.894
params at iteration - 55...
[1] "paramsOld\n"
[1] 1.198870e+03 3.672856e-02 2.668725e-01 2.046444e-01 4.917546e-01
[1] "paramsCurrent\n"
[1] 1.198894e+03 3.664106e-02 2.668605e-01 2.046962e-01 4.918022e-01
logLikelihood at iteration - 56...
[1] 1198.913
params at iteration - 56...
[1] "paramsOld\n"
[1] 1.198894e+03 3.664106e-02 2.668605e-01 2.046962e-01 4.918022e-01
[1] "paramsCurrent\n"
[1] 1.198913e+03 3.657379e-02 2.668488e-01 2.047526e-01 4.918247e-01
logLikelihood at iteration - 57...
[1] 1198.929
params at iteration - 57...
[1] "paramsOld\n"
[1] 1.198913e+03 3.657379e-02 2.668488e-01 2.047526e-01 4.918247e-01
[1] "paramsCurrent\n"
[1] 1.198929e+03 3.652254e-02 2.668377e-01 2.048088e-01 4.918310e-01
logLikelihood at iteration - 58...
[1] 1198.94
params at iteration - 58...
[1] "paramsOld\n"
[1] 1.198929e+03 3.652254e-02 2.668377e-01 2.048088e-01 4.918310e-01
[1] "paramsCurrent\n"
[1] 1.198940e+03 3.648367e-02 2.668272e-01 2.048615e-01 4.918276e-01
logLikelihood at iteration - 59...
[1] 1198.948
params at iteration - 59...
[1] "paramsOld\n"
[1] 1.198940e+03 3.648367e-02 2.668272e-01 2.048615e-01 4.918276e-01
[1] "paramsCurrent\n"
[1] 1.198948e+03 3.645424e-02 2.668176e-01 2.049090e-01 4.918191e-01
logLikelihood at iteration - 60...
[1] 1198.954
params at iteration - 60...
[1] "paramsOld\n"
[1] 1.198948e+03 3.645424e-02 2.668176e-01 2.049090e-01 4.918191e-01
[1] "paramsCurrent\n"
[1] 1.198954e+03 3.643194e-02 2.668089e-01 2.049508e-01 4.918083e-01
logLikelihood at iteration - 61...
[1] 1198.959
params at iteration - 61...
[1] "paramsOld\n"
[1] 1.198954e+03 3.643194e-02 2.668089e-01 2.049508e-01 4.918083e-01
[1] "paramsCurrent\n"
[1] 1.198959e+03 3.641501e-02 2.668012e-01 2.049868e-01 4.917970e-01
logLikelihood at iteration - 62...
[1] 1198.962
params at iteration - 62...
[1] "paramsOld\n"
[1] 1.198959e+03 3.641501e-02 2.668012e-01 2.049868e-01 4.917970e-01
[1] "paramsCurrent\n"
[1] 1.198962e+03 3.640211e-02 2.667944e-01 2.050174e-01 4.917861e-01
logLikelihood at iteration - 63...
[1] 1198.964
params at iteration - 63...
[1] "paramsOld\n"
[1] 1.198962e+03 3.640211e-02 2.667944e-01 2.050174e-01 4.917861e-01
[1] "paramsCurrent\n"
[1] 1.198964e+03 3.639225e-02 2.667884e-01 2.050431e-01 4.917762e-01
logLikelihood at iteration - 64...
[1] 1198.966
params at iteration - 64...
[1] "paramsOld\n"
[1] 1.198964e+03 3.639225e-02 2.667884e-01 2.050431e-01 4.917762e-01
[1] "paramsCurrent\n"
[1] 1.198966e+03 3.638468e-02 2.667833e-01 2.050645e-01 4.917675e-01
logLikelihood at iteration - 65...
[1] 1198.967
params at iteration - 65...
[1] "paramsOld\n"
[1] 1.198966e+03 3.638468e-02 2.667833e-01 2.050645e-01 4.917675e-01
[1] "paramsCurrent\n"
[1] 1.198967e+03 3.637886e-02 2.667790e-01 2.050822e-01 4.917600e-01
logLikelihood at iteration - 66...
[1] 1198.968
params at iteration - 66...
[1] "paramsOld\n"
[1] 1.198967e+03 3.637886e-02 2.667790e-01 2.050822e-01 4.917600e-01
[1] "paramsCurrent\n"
[1] 1.198968e+03 3.637436e-02 2.667753e-01 2.050967e-01 4.917536e-01
logLikelihood at iteration - 67...
[1] 1198.969
params at iteration - 67...
[1] "paramsOld\n"
[1] 1.198968e+03 3.637436e-02 2.667753e-01 2.050967e-01 4.917536e-01
[1] "paramsCurrent\n"
[1] 1.198969e+03 3.637087e-02 2.667722e-01 2.051087e-01 4.917483e-01
logLikelihood at iteration - 68...
[1] 1198.969
params at iteration - 68...
[1] "paramsOld\n"
[1] 1.198969e+03 3.637087e-02 2.667722e-01 2.051087e-01 4.917483e-01
[1] "paramsCurrent\n"
[1] 1.198969e+03 3.636815e-02 2.667696e-01 2.051185e-01 4.917438e-01
logLikelihood at iteration - 69...
[1] 1198.969
params at iteration - 69...
[1] "paramsOld\n"
[1] 1.198969e+03 3.636815e-02 2.667696e-01 2.051185e-01 4.917438e-01
[1] "paramsCurrent\n"
[1] 1.198969e+03 3.636603e-02 2.667674e-01 2.051264e-01 4.917401e-01
logLikelihood at iteration - 70...
[1] 1198.97
params at iteration - 70...
[1] "paramsOld\n"
[1] 1.198969e+03 3.636603e-02 2.667674e-01 2.051264e-01 4.917401e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636438e-02 2.667656e-01 2.051329e-01 4.917371e-01
logLikelihood at iteration - 71...
[1] 1198.97
params at iteration - 71...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636438e-02 2.667656e-01 2.051329e-01 4.917371e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636308e-02 2.667641e-01 2.051382e-01 4.917346e-01
logLikelihood at iteration - 72...
[1] 1198.97
params at iteration - 72...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636308e-02 2.667641e-01 2.051382e-01 4.917346e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636205e-02 2.667629e-01 2.051424e-01 4.917326e-01
logLikelihood at iteration - 73...
[1] 1198.97
params at iteration - 73...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636205e-02 2.667629e-01 2.051424e-01 4.917326e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636125e-02 2.667619e-01 2.051458e-01 4.917310e-01
logLikelihood at iteration - 74...
[1] 1198.97
params at iteration - 74...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636125e-02 2.667619e-01 2.051458e-01 4.917310e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636061e-02 2.667611e-01 2.051486e-01 4.917297e-01
logLikelihood at iteration - 75...
[1] 1198.97
params at iteration - 75...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636061e-02 2.667611e-01 2.051486e-01 4.917297e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.636011e-02 2.667604e-01 2.051509e-01 4.917286e-01
logLikelihood at iteration - 76...
[1] 1198.97
params at iteration - 76...
[1] "paramsOld\n"
[1] 1.198970e+03 3.636011e-02 2.667604e-01 2.051509e-01 4.917286e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635971e-02 2.667599e-01 2.051527e-01 4.917277e-01
logLikelihood at iteration - 77...
[1] 1198.97
params at iteration - 77...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635971e-02 2.667599e-01 2.051527e-01 4.917277e-01
[1] "paramsCurrent\n"
[1] 1198.9703841    0.0363594    0.2667595    0.2051541    0.4917270
logLikelihood at iteration - 78...
[1] 1198.97
params at iteration - 78...
[1] "paramsOld\n"
[1] 1198.9703841    0.0363594    0.2667595    0.2051541    0.4917270
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635915e-02 2.667591e-01 2.051553e-01 4.917264e-01
logLikelihood at iteration - 79...
[1] 1198.97
params at iteration - 79...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635915e-02 2.667591e-01 2.051553e-01 4.917264e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635895e-02 2.667588e-01 2.051563e-01 4.917260e-01
logLikelihood at iteration - 80...
[1] 1198.97
params at iteration - 80...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635895e-02 2.667588e-01 2.051563e-01 4.917260e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635879e-02 2.667586e-01 2.051570e-01 4.917256e-01
logLikelihood at iteration - 81...
[1] 1198.97
params at iteration - 81...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635879e-02 2.667586e-01 2.051570e-01 4.917256e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635866e-02 2.667584e-01 2.051576e-01 4.917253e-01
logLikelihood at iteration - 82...
[1] 1198.97
params at iteration - 82...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635866e-02 2.667584e-01 2.051576e-01 4.917253e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635856e-02 2.667582e-01 2.051581e-01 4.917251e-01
logLikelihood at iteration - 83...
[1] 1198.97
params at iteration - 83...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635856e-02 2.667582e-01 2.051581e-01 4.917251e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635848e-02 2.667581e-01 2.051585e-01 4.917249e-01
logLikelihood at iteration - 84...
[1] 1198.97
params at iteration - 84...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635848e-02 2.667581e-01 2.051585e-01 4.917249e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635842e-02 2.667580e-01 2.051588e-01 4.917248e-01
logLikelihood at iteration - 85...
[1] 1198.97
params at iteration - 85...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635842e-02 2.667580e-01 2.051588e-01 4.917248e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635837e-02 2.667579e-01 2.051591e-01 4.917246e-01
logLikelihood at iteration - 86...
[1] 1198.97
params at iteration - 86...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635837e-02 2.667579e-01 2.051591e-01 4.917246e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635833e-02 2.667579e-01 2.051593e-01 4.917245e-01
logLikelihood at iteration - 87...
[1] 1198.97
params at iteration - 87...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635833e-02 2.667579e-01 2.051593e-01 4.917245e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635829e-02 2.667578e-01 2.051594e-01 4.917245e-01
logLikelihood at iteration - 88...
[1] 1198.97
params at iteration - 88...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635829e-02 2.667578e-01 2.051594e-01 4.917245e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635827e-02 2.667578e-01 2.051596e-01 4.917244e-01
logLikelihood at iteration - 89...
[1] 1198.97
params at iteration - 89...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635827e-02 2.667578e-01 2.051596e-01 4.917244e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635825e-02 2.667577e-01 2.051597e-01 4.917243e-01
logLikelihood at iteration - 90...
[1] 1198.97
params at iteration - 90...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635825e-02 2.667577e-01 2.051597e-01 4.917243e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635823e-02 2.667577e-01 2.051598e-01 4.917243e-01
logLikelihood at iteration - 91...
[1] 1198.97
params at iteration - 91...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635823e-02 2.667577e-01 2.051598e-01 4.917243e-01
[1] "paramsCurrent\n"
[1] 1.198970e+03 3.635822e-02 2.667577e-01 2.051598e-01 4.917243e-01
logLikelihood at iteration - 92...
[1] 1198.97
params at iteration - 92...
[1] "paramsOld\n"
[1] 1.198970e+03 3.635822e-02 2.667577e-01 2.051598e-01 4.917243e-01
[1] "paramsCurrent\n"
[1] 1198.9704999    0.0363582    0.2667577    0.2051599    0.4917242
logLikelihood at iteration - 93...
[1] 1198.971
params at iteration - 93...
[1] "paramsOld\n"
[1] 1198.9704999    0.0363582    0.2667577    0.2051599    0.4917242
[1] "paramsCurrent\n"
[1] 1198.9705006    0.0363582    0.2667577    0.2051599    0.4917242
> 
> print(results)
$probs
[1] 0.0363582 0.2667577 0.2051599 0.4917242

$mu
               Age Annual Income (k$) Spending Score (1-100)
Cluster 1 43.68682           25.05011               7.854579
Cluster 2 45.99584           55.78405              49.779623
Cluster 3 40.95256           64.10416              64.018983
Cluster 4 33.73854           64.29782              47.793449

$var
$var$`Cluster 1`
             Age Annual.Income..k.. Spending.Score..1.100.
[1,] 152.0722474          69.202891             -0.8295675
[2,]  69.2028912          40.160860              1.0369717
[3,]  -0.8295675           1.036972             17.0927006

$var$`Cluster 2`
            Age Annual.Income..k.. Spending.Score..1.100.
[1,] 311.935852          -25.57987               2.000885
[2,] -25.579869           61.09805             -20.966921
[3,]   2.000885          -20.96692              34.454566

$var$`Cluster 3`
           Age Annual.Income..k.. Spending.Score..1.100.
[1,]  117.2334          -211.7453              -250.2167
[2,] -211.7453           503.3354               545.5659
[3,] -250.2167           545.5659               672.6439

$var$`Cluster 4`
           Age Annual.Income..k.. Spending.Score..1.100.
[1,]  108.0672           135.1118              -143.1305
[2,]  135.1118          1024.9361              -326.4461
[3,] -143.1305          -326.4461               830.6274


$resp
                [,1]         [,2]         [,3]         [,4]
  [1,]  3.245876e-12 1.621715e-11 3.269154e-14 1.000000e+00
  [2,]  7.632116e-69 1.261902e-08 1.130499e-18 1.000000e+00
  [3,]  9.830119e-01 7.486788e-34 3.103153e-18 1.698806e-02
  [4,]  1.764209e-61 1.931658e-07 2.122920e-16 9.999998e-01
  [5,]  1.913059e-13 6.453441e-10 1.836932e-07 9.999998e-01
  [6,]  1.953502e-59 4.569202e-07 4.075118e-16 9.999995e-01
  [7,]  9.760416e-01 4.105410e-32 1.226956e-08 2.395844e-02
  [8,]  1.207951e-94 9.108228e-13 3.421864e-20 1.000000e+00
  [9,]  6.712457e-06 3.195617e-32 9.988818e-01 1.111517e-03
 [10,]  9.409431e-53 1.288594e-05 1.710557e-11 9.999871e-01
 [11,]  4.069461e-08 1.166160e-22 9.995433e-01 4.566789e-04
 [12,] 8.283222e-107 2.170592e-14 9.903234e-19 1.000000e+00
 [13,]  1.666985e-04 5.946972e-22 9.948255e-01 5.007784e-03
 [14,]  7.300647e-61 1.334120e-06 3.106666e-14 9.999987e-01
 [15,]  9.372172e-01 1.083327e-24 2.671214e-06 6.278013e-02
 [16,]  2.016727e-64 3.878532e-07 1.950135e-15 9.999996e-01
 [17,]  4.312225e-09 4.621948e-10 7.516881e-05 9.999248e-01
 [18,]  2.920754e-43 5.565524e-05 1.510130e-13 9.999443e-01
 [19,]  7.461404e-07 1.440966e-11 9.305581e-01 6.944118e-02
 [20,] 4.953239e-103 1.117847e-13 2.392925e-16 1.000000e+00
 [21,]  4.895823e-09 6.315644e-09 2.236387e-04 9.997764e-01
 [22,]  4.010445e-54 4.525012e-05 1.876369e-11 9.999547e-01
 [23,]  9.889164e-01 1.077959e-28 2.207931e-04 1.086283e-02
 [24,]  8.926264e-54 1.260637e-04 3.522476e-09 9.998739e-01
 [25,]  7.046766e-01 3.517859e-19 2.812858e-01 1.403766e-02
 [26,]  5.077982e-70 9.946884e-07 1.559648e-10 9.999990e-01
 [27,]  6.650105e-07 2.958908e-08 4.539476e-01 5.460517e-01
 [28,]  7.335529e-36 1.062676e-02 3.161836e-05 9.893416e-01
 [29,]  1.076658e-06 1.520192e-08 3.620154e-02 9.637974e-01
 [30,]  8.312138e-81 8.494620e-09 5.551603e-13 1.000000e+00
 [31,]  9.515103e-01 4.308348e-26 4.594467e-02 2.545009e-03
 [32,]  1.122147e-56 2.651153e-04 8.851081e-11 9.997349e-01
 [33,]  9.717676e-01 9.661352e-25 6.495874e-03 2.173650e-02
 [34,]  3.654328e-94 3.755668e-11 5.030243e-14 1.000000e+00
 [35,]  7.399043e-01 1.043073e-16 1.107427e-01 1.493530e-01
 [36,]  5.427196e-72 2.570345e-06 6.900622e-11 9.999974e-01
 [37,]  1.841736e-02 3.767282e-14 1.406724e-02 9.675154e-01
 [38,]  2.227384e-56 1.144474e-03 1.482401e-06 9.988540e-01
 [39,]  6.701181e-09 1.612568e-08 1.484343e-03 9.985156e-01
 [40,]  4.252169e-65 3.215732e-04 4.402925e-09 9.996784e-01
 [41,]  6.378255e-09 3.056959e-03 9.812709e-01 1.567215e-02
 [42,]  1.358804e-95 3.016106e-11 3.463959e-10 1.000000e+00
 [43,]  8.833717e-13 3.160570e-04 9.065030e-01 9.318091e-02
 [44,]  4.327395e-42 1.873899e-01 6.032750e-04 8.120069e-01
 [45,]  1.022039e-07 5.661771e-07 8.644323e-01 1.355670e-01
 [46,]  3.090951e-50 5.549257e-02 2.541346e-06 9.445049e-01
 [47,]  3.266792e-30 7.106390e-01 2.282092e-01 6.115183e-02
 [48,]  3.115613e-29 9.062206e-02 5.127142e-05 9.093267e-01
 [49,]  5.464644e-24 1.487858e-02 1.656119e-04 9.849558e-01
 [50,]  4.239435e-23 1.656899e-02 8.947846e-04 9.825362e-01
 [51,]  2.777649e-28 5.500215e-01 3.994844e-01 5.049404e-02
 [52,]  1.234678e-42 3.659365e-01 5.869161e-03 6.281943e-01
 [53,]  1.276642e-37 4.855154e-01 2.441749e-03 5.120428e-01
 [54,]  3.920072e-36 9.905908e-01 4.602782e-03 4.806401e-03
 [55,]  8.681877e-22 1.405267e-01 8.171882e-01 4.228510e-02
 [56,]  3.299928e-19 2.882180e-02 8.763711e-01 9.480712e-02
 [57,]  5.333467e-27 5.407311e-01 4.327011e-01 2.656783e-02
 [58,]  9.524484e-20 9.992169e-01 4.993539e-04 2.837101e-04
 [59,]  3.529844e-40 5.670437e-01 1.875376e-04 4.327688e-01
 [60,]  7.149349e-24 4.194398e-01 5.601274e-01 2.043283e-02
 [61,]  1.880366e-31 9.999617e-01 2.081391e-06 3.617875e-05
 [62,]  2.334880e-49 6.158517e-01 1.969393e-07 3.841481e-01
 [63,]  1.325217e-27 9.997681e-01 1.019579e-04 1.299460e-04
 [64,]  4.030679e-38 9.089894e-01 7.576452e-02 1.524612e-02
 [65,]  1.057754e-27 9.969199e-01 2.467803e-03 6.123154e-04
 [66,]  1.802007e-57 5.569621e-01 2.944160e-07 4.430376e-01
 [67,]  2.381049e-33 5.834327e-01 3.375490e-01 7.901825e-02
 [68,]  1.236057e-23 9.997052e-01 1.542780e-04 1.405388e-04
 [69,]  9.212729e-57 5.413379e-01 8.109280e-07 4.586613e-01
 [70,]  5.657258e-36 5.694188e-01 6.041643e-03 4.245395e-01
 [71,]  2.146384e-31 9.999637e-01 2.274779e-06 3.404039e-05
 [72,]  3.211266e-25 2.095275e-01 7.064963e-01 8.397613e-02
 [73,]  1.054925e-27 9.794735e-01 1.866242e-02 1.864092e-03
 [74,]  3.880906e-35 9.923843e-01 5.905795e-03 1.709898e-03
 [75,]  1.562214e-29 9.737192e-01 2.334950e-02 2.931279e-03
 [76,]  5.371280e-56 7.548638e-01 3.697129e-04 2.447665e-01
 [77,]  2.308957e-42 6.043659e-01 3.567715e-01 3.886263e-02
 [78,]  2.295303e-40 7.354768e-01 1.581052e-01 1.064180e-01
 [79,]  1.921918e-56 8.000003e-01 1.732515e-05 1.999824e-01
 [80,]  8.603388e-30 5.007487e-01 4.374557e-01 6.179557e-02
 [81,]  2.660582e-34 9.597017e-01 3.658649e-02 3.711854e-03
 [82,]  1.589700e-48 6.578284e-01 2.033520e-01 1.388196e-01
 [83,]  5.536698e-21 9.981516e-01 8.618647e-04 9.865210e-04
 [84,]  3.431705e-33 5.682950e-01 3.624124e-01 6.929258e-02
 [85,]  4.591655e-63 6.827336e-01 1.478694e-05 3.172516e-01
 [86,]  6.577871e-34 6.294591e-01 3.359871e-01 3.455375e-02
 [87,]  1.597734e-45 8.550292e-01 1.252800e-01 1.969074e-02
 [88,]  9.880619e-66 7.422642e-01 3.133155e-05 2.577045e-01
 [89,]  8.602755e-63 2.768873e-01 2.760889e-01 4.470238e-01
 [90,]  6.802435e-38 7.884908e-01 1.837029e-01 2.780637e-02
 [91,]  1.690184e-38 9.997355e-01 1.094913e-05 2.535388e-04
 [92,]  1.742768e-61 7.333075e-01 3.942437e-09 2.666925e-01
 [93,]  9.603164e-45 7.493468e-01 2.140879e-01 3.656533e-02
 [94,]  6.403844e-43 6.074704e-01 3.894014e-02 3.535895e-01
 [95,]  3.833837e-51 6.523472e-01 1.184495e-03 3.464683e-01
 [96,]  6.045511e-67 7.791078e-01 7.789905e-05 2.208143e-01
 [97,]  1.289374e-43 7.648642e-01 1.876128e-01 4.752303e-02
 [98,]  2.415266e-62 7.918798e-01 3.730296e-04 2.077471e-01
 [99,]  3.783822e-40 7.848282e-01 1.227161e-01 9.245573e-02
[100,]  2.439939e-70 8.517137e-01 6.037458e-07 1.482857e-01
[101,]  4.666537e-63 6.729510e-01 5.594193e-07 3.270485e-01
[102,]  3.984167e-46 8.054559e-01 1.526666e-01 4.187746e-02
[103,]  7.928607e-46 9.974803e-01 5.210020e-05 2.467582e-03
[104,]  7.019102e-72 5.871509e-01 1.638329e-03 4.112108e-01
[105,]  8.920737e-54 4.218245e-01 5.153388e-01 6.283671e-02
[106,]  7.209021e-66 7.512748e-01 1.086605e-07 2.487251e-01
[107,]  1.139561e-38 9.992435e-01 4.434429e-05 7.121079e-04
[108,]  2.348765e-42 9.389560e-01 3.922890e-02 2.181512e-02
[109,]  2.068493e-31 9.994281e-01 1.113780e-05 5.607409e-04
[110,]  7.558173e-37 9.992757e-01 4.283849e-05 6.814902e-04
[111,]  4.639160e-41 9.986730e-01 1.174420e-04 1.209588e-03
[112,]  3.301174e-80 7.193692e-01 3.375067e-06 2.806275e-01
[113,]  1.632888e-53 6.822144e-01 1.158457e-02 3.062010e-01
[114,]  9.664826e-76 8.466475e-01 6.105186e-08 1.533524e-01
[115,]  7.622561e-81 8.466990e-01 5.821463e-08 1.533009e-01
[116,]  2.403755e-81 8.023087e-01 4.868734e-07 1.976908e-01
[117,]  8.426576e-37 9.956288e-01 2.913483e-04 4.079884e-03
[118,]  1.046923e-61 1.212144e-01 7.585134e-01 1.202722e-01
[119,]  1.377211e-48 8.746883e-01 2.847940e-02 9.683231e-02
[120,]  5.945732e-62 2.256247e-01 6.055132e-01 1.688621e-01
[121,]  1.273958e-82 2.515026e-01 7.362697e-03 7.411347e-01
[122,]  3.929010e-58 5.326299e-01 3.434615e-03 4.639354e-01
[123,]  4.241287e-76 3.374062e-02 6.556870e-01 3.105724e-01
[124,] 2.585397e-126 1.206933e-16 4.313538e-01 5.686462e-01
[125,]  4.506003e-76 2.175868e-02 1.318989e-10 9.782413e-01
[126,] 1.144471e-112 4.130776e-09 6.956671e-01 3.043329e-01
[127,]  1.262031e-58 1.972754e-01 6.903100e-04 8.020343e-01
[128,] 4.336758e-137 3.713193e-20 2.738845e-01 7.261155e-01
[129,]  3.229348e-37 2.193273e-08 7.700023e-09 1.000000e+00
[130,] 7.431806e-105 1.061376e-08 8.824404e-01 1.175596e-01
[131,]  1.478457e-49 2.694057e-10 1.459796e-10 1.000000e+00
[132,] 7.822401e-104 1.107227e-08 8.870236e-01 1.129764e-01
[133,]  4.742299e-81 1.391948e-01 1.189046e-08 8.608052e-01
[134,] 1.887125e-108 7.888286e-07 6.234451e-01 3.765542e-01
[135,]  1.044507e-87 5.789049e-12 1.378953e-22 1.000000e+00
[136,] 2.396281e-140 1.941586e-16 6.661150e-01 3.338850e-01
[137,]  7.067026e-58 2.287028e-11 1.306052e-12 1.000000e+00
[138,] 1.019736e-112 4.146900e-08 7.404047e-01 2.595953e-01
[139,]  6.254286e-91 4.792184e-09 5.397427e-21 1.000000e+00
[140,] 1.806113e-110 4.382046e-08 8.250688e-01 1.749312e-01
[141,]  1.108989e-48 1.054930e-11 1.788867e-12 1.000000e+00
[142,] 3.379260e-151 6.998240e-21 7.336223e-01 2.663777e-01
[143,]  1.767948e-91 1.930645e-01 1.178681e-06 8.069343e-01
[144,] 7.950938e-143 3.351383e-17 8.522581e-01 1.477419e-01
[145,]  1.122869e-91 2.682681e-08 4.713644e-18 1.000000e+00
[146,] 8.526125e-169 7.937392e-25 6.605973e-01 3.394027e-01
[147,]  1.458405e-67 1.350600e-01 1.164102e-04 8.648236e-01
[148,] 2.764726e-124 8.604324e-10 7.644251e-01 2.355749e-01
[149,]  9.463792e-83 9.207661e-05 4.356534e-11 9.999079e-01
[150,] 5.525362e-151 3.717767e-20 8.735323e-01 1.264677e-01
[151,]  6.299967e-71 1.810873e-06 6.773947e-11 9.999982e-01
[152,] 2.736023e-141 1.599542e-18 8.492620e-01 1.507380e-01
[153,]  6.959257e-70 2.386594e-05 1.068420e-09 9.999761e-01
[154,] 8.457826e-123 2.499291e-11 8.775162e-01 1.224838e-01
[155,]  5.040128e-66 9.567330e-07 1.170404e-10 9.999990e-01
[156,] 1.325766e-157 3.518900e-19 7.784302e-01 2.215698e-01
[157,]  1.996442e-81 1.194828e-14 5.093115e-19 1.000000e+00
[158,] 2.030965e-135 3.249252e-12 7.800285e-01 2.199715e-01
[159,]  2.263564e-85 1.342609e-14 4.983264e-20 1.000000e+00
[160,] 8.148619e-128 2.060463e-09 6.225018e-01 3.774982e-01
[161,]  1.052268e-62 1.846937e-01 1.200405e-05 8.152943e-01
[162,] 1.663087e-147 1.216560e-15 8.293386e-01 1.706614e-01
[163,] 9.987259e-115 3.194350e-11 9.170534e-26 1.000000e+00
[164,] 2.048331e-168 7.610257e-24 8.923937e-01 1.076063e-01
[165,]  2.700806e-82 4.312756e-04 9.353257e-10 9.995687e-01
[166,] 1.191008e-142 4.534783e-13 7.315138e-01 2.684862e-01
[167,]  2.241195e-95 5.682020e-06 6.752856e-13 9.999943e-01
[168,] 5.247970e-184 4.598120e-28 9.249883e-01 7.501166e-02
[169,] 2.907015e-108 2.104662e-04 1.243602e-11 9.997895e-01
[170,] 1.696372e-138 9.427499e-08 2.682894e-02 9.731710e-01
[171,] 1.335686e-101 1.674086e-08 1.549662e-16 1.000000e+00
[172,] 7.084779e-160 1.921661e-13 4.084621e-01 5.915379e-01
[173,] 5.067846e-108 1.034138e-09 7.847724e-19 1.000000e+00
[174,] 5.395180e-177 5.927253e-26 9.068726e-01 9.312743e-02
[175,]  1.731024e-87 2.441596e-08 1.416023e-15 1.000000e+00
[176,] 5.522151e-178 9.335160e-22 8.962332e-01 1.037668e-01
[177,]  4.394972e-79 3.218941e-07 7.237327e-15 9.999997e-01
[178,] 2.216220e-156 1.624630e-10 5.373238e-02 9.462676e-01
[179,]  1.567426e-92 3.382494e-08 8.168792e-18 1.000000e+00
[180,] 1.880388e-193 2.161712e-27 8.822553e-01 1.177447e-01
[181,] 1.163452e-142 6.690157e-06 3.511259e-13 9.999933e-01
[182,] 8.931002e-205 4.814899e-26 7.432578e-01 2.567422e-01
[183,] 1.840336e-129 3.048633e-09 5.810618e-20 1.000000e+00
[184,] 6.314612e-217 3.097401e-28 8.003201e-01 1.996799e-01
[185,] 5.157446e-146 1.357521e-06 5.084643e-11 9.999986e-01
[186,] 1.015134e-235 2.187488e-37 9.413673e-01 5.863271e-02
[187,] 6.805232e-127 1.239881e-07 1.140494e-17 9.999999e-01
[188,] 1.364553e-200 1.161059e-15 5.570272e-04 9.994430e-01
[189,] 6.094580e-157 9.736339e-10 4.596635e-22 1.000000e+00
[190,] 7.261568e-218 2.520810e-28 2.059214e-01 7.940786e-01
[191,] 9.732311e-170 2.603180e-08 3.565743e-20 1.000000e+00
[192,] 2.041811e-202 2.275496e-17 6.237315e-04 9.993763e-01
[193,] 5.072938e-218 1.556840e-14 3.582230e-34 1.000000e+00
[194,] 4.603200e-264 3.576217e-40 1.422735e-02 9.857726e-01
[195,] 9.145496e-219 2.080738e-15 2.452387e-32 1.000000e+00
[196,] 8.094971e-283 9.087161e-35 4.453313e-06 9.999955e-01
[197,] 9.236720e-252 2.649333e-17 1.447686e-29 1.000000e+00
[198,] 2.354725e-312 3.719200e-35 3.621402e-09 1.000000e+00
[199,]  0.000000e+00 3.120164e-22 1.129516e-43 1.000000e+00
[200,]  0.000000e+00 1.019742e-51 4.229184e-10 1.000000e+00

$cluster
  [1] 4 4 1 4 4 4 1 4 3 4 3 4 3 4 1 4 4 4 3 4 4 4 1 4 1 4 4 4 4 4 1 4 1 4 1 4 4
 [38] 4 4 4 3 4 3 4 3 4 2 4 4 4 2 4 4 2 3 3 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 3 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2
[112] 2 2 2 2 2 3 2 3 4 2 3 4 4 3 4 4 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4
[149] 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 4 4 4 4 3 4 3 4 4 4 3 4 3 4 3 4 3
[186] 4 4 4 4 4 4 4 4 4 4 4 4 4 4

$logLikelihood
[1] 1198.971

> library(ggplot2)
> 
> png(paste0('D:/Projects/EM-algorithm/plots/em-mgmm-plot-mall-customers-examp$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,2], y = X[,3], color = as.factor(c(results$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(results$mu), aes(x = results$mu[,2], y = r$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[2],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> png(paste0('D:/Projects/EM-algorithm/plots/em-mgmm-plot-mall-customers-examp$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,1], y = X[,3], color = as.factor(c(results$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(results$mu), aes(x = results$mu[,1], y = r$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[1],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> png(paste0('D:/Projects/EM-algorithm/plots/em-mgmm-plot-mall-customers-examp$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,1], y = X[,2], color = as.factor(c(results$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(results$mu), aes(x = results$mu[,1], y = r$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[1],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> km_data_2 <- kmeans(MallCustomers, 4, nstart=1500) 
> 
> print(km_data_2)
K-means clustering with 4 clusters of sizes 39, 38, 28, 95

Cluster means:
     Gender      Age Annual.Income..k.. Spending.Score..1.100.
1 0.4615385 32.69231           86.53846               82.12821
2 0.5263158 40.39474           87.00000               18.63158
3 0.5000000 24.82143           28.71429               74.25000
4 0.3789474 44.89474           48.70526               42.63158

Clustering vector:
  [1] 3 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4
 [38] 3 4 3 4 3 4 3 4 3 4 4 4 4 4 3 4 4 4 4 4 4 4 4 4 3 4 4 4 3 4 4 3 4 4 4 4 4
 [75] 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4
[112] 4 4 4 4 4 4 4 4 4 4 4 4 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1
[149] 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1 2
[186] 1 2 1 2 1 2 1 2 1 2 1 2 1 2 1

Within cluster sum of squares by cluster:
[1] 13982.051 19003.395  9106.071 62323.158
 (between_SS / total_SS =  66.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"
> library(ggplot2)
> 
> png(paste0('D:/Projects/EM-algorithm/plots/kmeans-plot-mall-customers-exampl$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,2], y = X[,3], color = as.factor(km_data_2$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(km_data_2$centers), aes(x = km_data_2$cent$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[2],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> png(paste0('D:/Projects/EM-algorithm/plots/kmeans-plot-mall-customers-exampl$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,1], y = X[,3], color = as.factor(km_data_2$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(km_data_2$centers), aes(x = km_data_2$cent$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[1],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
> png(paste0('D:/Projects/EM-algorithm/plots/kmeans-plot-mall-customers-exampl$
> 
> options(repr.plot.width = 5, repr.plot.height =5)
> # Scatter plot of clusters
> ggplot(data = X, aes(x = X[,1], y = X[,2], color = as.factor(km_data_2$clust$
+   geom_point(size = 3) +
+   geom_point(data = as.data.frame(km_data_2$centers), aes(x = km_data_2$cent$
+   labs(title = "Scatter Plot of Clusters and Centroids", x = colnames(X)[1],$
+   theme(text = element_text(size = 15), aspect.ratio = 1)
> 
> dev.off()
null device 
          1
>